(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     90805,       1996]
NotebookOptionsPosition[     88503,       1961]
NotebookOutlinePosition[     88934,       1978]
CellTagsIndexPosition[     88891,       1975]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", "\"\<ASRs`\>\"", "]"}], ";"}]], "Code",
 CellChangeTimes->{{3.965430596005556*^9, 3.9654306054256306`*^9}, 
   3.965431487585346*^9, {3.965431695058737*^9, 3.9654316957862053`*^9}, {
   3.965436674649887*^9, 3.965436675068756*^9}, {3.966813720543049*^9, 
   3.966813725539713*^9}, {3.966813765189234*^9, 
   3.9668137888759785`*^9}},ExpressionUUID->"d7755607-cbd2-374e-ad05-\
ec3d71bc527b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ASRsHelp", "::", "usage"}], 
    "=", "\"\<ASRsHelp[function] prints extended documentation on a \
function's arguments, options, and outputs.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"startPythonSession", "::", "usage"}], 
    "=", "\"\<startPythonSession[session,path] checks for a valid Python \
session and file path and loads in the Python file.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"generateASRs", "::", "usage"}], 
   "=", "\"\<generateASRs[in,h,out] finds all amplitudes and amplitude sum \
rules (ASRs) for a given system.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"generateASRs", "::", "details"}], "=", 
    "\n", "\"\<Arguments:\nin (List): Contains U-spins (Real) OR particle \
multiplets (List of Strings) in the incoming state\nh (List): Contains \
U-spins (Real) OR CKM factors (List of Symbols) in the Hamiltonian\nout \
(List): Contains U-spins (Real) OR particle multiplets (List of Strings) in \
the outgoing state\n\nOptions:\nphys (True|False): Indicates whether function \
arguments contain U-spins (False) or particle multiplets/CKM factors (True). \
Default: phys->False.\n\nReturns:\nsystem (Association): All information \
about the system's representations, amplitudes, and amplitude sum rules. Keys \
and values:\n- \\\"n doublets\\\" (Real): Number of would-be doublets\n- \
\\\"Irreps\\\" (List): Inputted U-spin representations (List of Reals) in \
{incoming reps, H reps, outgoing reps} format\n- \\\"n amps\\\" (Real): \
Number of amplitudes in the system\n- \\\"Amplitudes\\\" (Association): \
Contains all amplitudes in the system. Keys and values:\n\t- \
\\\"Processes\\\" (List): Contains physical processes constructed from \
particle names (String) for a process and its U-spin conjugate procress. Only \
appears for physical systems.\n\t- \\\"QNs\\\" (List): Contains mathematical \
processes written using m quantum numbers (String), where m is the third \
component of U-spin\n\t- \\\"n-tuple\\\" (String): \n\t- \\\"Node\\\" \
(String)\n\t- \\\"Binary indices\\\" (List): Contains\n\t- \\\"q factor\\\" \
(Real): \n\t- \\\"p factor\\\" (Real): \n\t- \\\"mu\\\" (Real): \n\t- \
\\\"CG\\\" (Real): Clebsch-Gordan coefficient from symmetrization for systems \
without doublets. Equals 1 for all amplitudes for a system with at least one \
doublet.\n\t- \\\"CKM\\\" (List): Contains weak interaction factors (Real) \
from the Hamiltonian. Only appears for physical systems.\n- \\\"n ASRs\\\" \
(List): Contains number of amplitude sum rules (Real) at each order of \
breaking\n- \\\"ASRs\\\" (List): Contains matrices of amplitude sum rule \
coefficients (Real) corresponding to each order of breaking\>\""}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"numAmps", "::", "usage"}], 
    "=", "\"\<numAmps[amplitudes] returns the total number of amplitudes in \
the system.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"printAmps", "::", "usage"}], 
    "=", "\"\<printAmps[amplitudes] prints a table of amplitudes.\>\""}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"numASRs", "::", "usage"}], 
    "=", "\"\<numASRs[ASRs] returns the number of amplitude sum rules at each \
order of breaking.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"printASRs", "::", "usage"}], 
    "=", "\"\<printASRs[ASRs,amplitudes] prints amplitude sum rules at each \
order of breaking.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"printSystem", "::", "usage"}], 
   "=", "\"\<printSystem[system] prints information about the system's \
representations, amplitudes, and amplitude sum rules and modifies the system \
to include formatted sum rules.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"printSystem", "::", "details"}], "=", 
    "\n", "\"\<Arguments:\nsystem (Association): All information about the \
system's representations, amplitudes, and amplitude sum rules. Details about \
keys and values available in documentation for generateASRs.\n\nOptions:\n\
showReps (True|False): Default: showReps->True.\n-----\nshowAmps \
(True|False): Default: showAmps->True\nshowFactors (True|False): Indicates \
whether to print internal calculation factors from the sum rule algorithm in \
the amplitudes table (True) or not (False). Not to be confused with the \
amplitude sum rule matrices. Default: showFactors->False.\n-----\nshowASRs \
(True|False): Default: showASRs->True.\ntakeProd (True|False): Indicates \
whether to write each row of a sum rules matrix as an algebraic expression of \
amplitudes (True) or to keep each row as a list of coefficients (False). \
Default: takeProd->True.\nampFormat (String): Specified format for displaying \
amplitudes. Options are a/s-type amplitudes with n-tuples (\\\"a/s \
n-tuple\\\"), a/s-type amplitudes with numbered indices (\\\"a/s \
indices\\\"), a/s-type amplitudes with nodes (\\\"a/s nodes\\\"), A \
amplitudes with numbered indices (\\\"A indices\\\"), and A amplitudes with \
physical process (\\\"A physical\\\"). Default: ampFormat->\\\"a/s \
n-tuple\\\".\nCKM (True|False): Indicates whether to include CKM factors in \
the sum rules (True) or not (False). Default: CKM->False.\nb (All|Real|List): \
Breaking order(s) at which to print sum rules. User can print sum rules to \
all possible orders of breaking (All), at a particular order (Real s.t. 0 <= \
b <= highest order of breaking), or over a range of orders of breaking \
({start b (min: 0), end b (max: highest order of breaking, or All), \
increment}). Default: b->All.\n\nReturns:\nsystem (Association): The inputted \
system, modified to include formatted amplitude sum rules. New/modified keys \
and values:\n- \\\"Formatted ASRs\\\" (List): Contains Lists/matrices of \
amplitude sum rules/amplitude sum rule coefficients formatted according to \
sum rule printing settings.\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"labelAmps", "::", "usage"}], 
   "=", "\"\<labelAmps[amplitudes,colName,labels] adds a column of labels to \
amplitudes.\>\""}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"unlabelAmps", "::", "usage"}], 
  "=", "\"\<unlabelAmps[amplitudes,colNames] removes columns from amplitudes.\
\>\""}]}], "Code",
 CellChangeTimes->{{3.9654306305147057`*^9, 3.965430687936945*^9}, {
   3.965431386784767*^9, 3.9654314041288376`*^9}, 3.965431494843601*^9, {
   3.965433459651066*^9, 3.9654336153908634`*^9}, {3.9654336612445736`*^9, 
   3.9654336640781*^9}, {3.9654368292857323`*^9, 3.9654368396580105`*^9}, {
   3.9654370542961617`*^9, 3.965437058074848*^9}, {3.965437143758339*^9, 
   3.965437146562784*^9}, {3.9654735558952885`*^9, 3.9654735607306004`*^9}, 
   3.965473608819456*^9, {3.965473653434969*^9, 3.965473666441969*^9}, {
   3.9654737191186695`*^9, 3.9654737457297726`*^9}, 3.96547387173028*^9, {
   3.965473974708271*^9, 3.96547401987434*^9}, {3.9654740726305447`*^9, 
   3.965474090206953*^9}, {3.9654741840132637`*^9, 3.9654742862256107`*^9}, {
   3.965474331773567*^9, 3.9654743744081936`*^9}, {3.9654744926430244`*^9, 
   3.9654749783951797`*^9}, {3.9654750155179806`*^9, 3.965475109192539*^9}, {
   3.9654751515308037`*^9, 3.965475188568512*^9}, {3.965475319154829*^9, 
   3.9654755854437656`*^9}, {3.9654756251011696`*^9, 
   3.9654756454827213`*^9}, {3.9654756901737614`*^9, 3.965475716046379*^9}, {
   3.96547585572822*^9, 3.9654759444997406`*^9}, {3.9654759783196945`*^9, 
   3.9654760030095177`*^9}, {3.965476046154745*^9, 3.965476046342926*^9}, {
   3.965476807708885*^9, 3.965476863496973*^9}, {3.9654798658294296`*^9, 
   3.965479887201605*^9}, {3.966277108433735*^9, 3.9662771728381863`*^9}, {
   3.9662774716504536`*^9, 3.9662774748942986`*^9}, {3.9662777060328465`*^9, 
   3.9662777099280834`*^9}, {3.966278145282234*^9, 3.9662782340474567`*^9}, {
   3.9662787396963673`*^9, 3.9662787567269897`*^9}, {3.966278922529766*^9, 
   3.966279161194292*^9}, {3.966279228589081*^9, 3.966279234317894*^9}, {
   3.966279285534815*^9, 3.9662793235169735`*^9}, {3.9662794184552937`*^9, 
   3.9662796195456524`*^9}, {3.966279654497282*^9, 3.966279708014412*^9}, {
   3.9662797396910973`*^9, 3.966279881337719*^9}, {3.966280081454815*^9, 
   3.966280168164156*^9}, 3.966280350095312*^9, {3.966280393296152*^9, 
   3.966280578000164*^9}, {3.9662806099045773`*^9, 3.966280615664484*^9}, {
   3.9662836697917843`*^9, 3.966283708503294*^9}, {3.9662837677166157`*^9, 
   3.966283769939001*^9}, {3.9662840511179333`*^9, 3.966284083971283*^9}, {
   3.966284707037195*^9, 3.9662847168562946`*^9}, {3.966284762945429*^9, 
   3.96628482249695*^9}, {3.966284872408373*^9, 3.9662848923749886`*^9}, {
   3.9662851597837543`*^9, 3.9662851680008507`*^9}, {3.9662852012134247`*^9, 
   3.966285202307993*^9}, {3.9662853794698925`*^9, 3.9662854673739223`*^9}, {
   3.966285532777197*^9, 3.9662855341198025`*^9}, {3.9663525633067436`*^9, 
   3.9663527254860153`*^9}, {3.966352757422737*^9, 3.9663528590276184`*^9}, {
   3.966352898604208*^9, 3.9663530290137596`*^9}, {3.9663530767139206`*^9, 
   3.9663530777101593`*^9}, {3.966353137373062*^9, 3.9663531787451687`*^9}, {
   3.9663532340886383`*^9, 3.966353674353443*^9}, {3.9663537355141296`*^9, 
   3.966353746789667*^9}, {3.96635384052956*^9, 3.966353890186102*^9}, {
   3.966353944453165*^9, 3.9663541081862698`*^9}, {3.9663541490410175`*^9, 
   3.966354215914301*^9}, {3.9663542558120995`*^9, 3.966354271694948*^9}, {
   3.966354407179323*^9, 3.9663546445026703`*^9}, {3.966374024448387*^9, 
   3.966374070079279*^9}, {3.9663766615650024`*^9, 3.9663766847964783`*^9}, {
   3.9663767195308743`*^9, 3.9663767577559834`*^9}, {3.966376804819599*^9, 
   3.96637680731571*^9}, {3.966376839525812*^9, 3.9663768620557156`*^9}, {
   3.9666930160471687`*^9, 3.9666930174073925`*^9}, {3.966693202666342*^9, 
   3.9666932048139343`*^9}, {3.9668052143011055`*^9, 
   3.9668052250198555`*^9}, {3.9668052622786865`*^9, 
   3.9668053374735813`*^9}, {3.966805378137249*^9, 3.9668054206073246`*^9}, {
   3.9668054545757504`*^9, 3.966805460431135*^9}, {3.966805620477873*^9, 
   3.966805813205002*^9}, {3.9668058492388477`*^9, 3.9668060602113132`*^9}, 
   3.966806158443159*^9, {3.966806259920067*^9, 3.966806383292507*^9}, {
   3.9668071451867466`*^9, 3.9668072097687683`*^9}, {3.96680724689608*^9, 
   3.966807309275898*^9}, {3.9668073428544426`*^9, 3.966807413776575*^9}, {
   3.9668074799578514`*^9, 3.9668074885345135`*^9}, {3.9668083015189857`*^9, 
   3.9668083710669365`*^9}, {3.9668084056114616`*^9, 3.966808452880913*^9}, {
   3.9668087794030533`*^9, 3.9668088181254997`*^9}, {3.9668088675404224`*^9, 
   3.9668088680407867`*^9}, {3.9668089196501484`*^9, 
   3.9668089343635273`*^9}, {3.96680900805818*^9, 3.966809054013817*^9}, {
   3.9668093146271305`*^9, 3.9668093159224777`*^9}, {3.9668111280159664`*^9, 
   3.966811170627531*^9}, {3.9668113680569153`*^9, 3.9668114199241047`*^9}, {
   3.966811456498125*^9, 3.966811523909313*^9}, {3.966811554200596*^9, 
   3.9668116546215096`*^9}, 3.966812036643444*^9, {3.9668121894900265`*^9, 
   3.9668121943285713`*^9}, {3.966813449079777*^9, 3.9668134922596893`*^9}, {
   3.96681352799308*^9, 3.9668135954989376`*^9}, 3.966813650460764*^9, 
   3.9668823962535534`*^9, {3.9668824363728294`*^9, 3.9668824537686405`*^9}, {
   3.9668825521812096`*^9, 3.966882570922573*^9}, {3.9668993930028744`*^9, 
   3.966899442128599*^9}, {3.966899480852619*^9, 3.9668994827675095`*^9}, {
   3.9668995749711*^9, 3.9668996534686184`*^9}, {3.966951885148674*^9, 
   3.9669519359453545`*^9}, {3.966952039758171*^9, 3.966952046974148*^9}, {
   3.9669520777910976`*^9, 3.966952182757551*^9}, {3.966952261716816*^9, 
   3.9669522634030285`*^9}, {3.9669577138317223`*^9, 3.966957747218666*^9}, {
   3.9676492333448086`*^9, 3.9676492344979305`*^9}, {3.967649359473692*^9, 
   3.9676494293187447`*^9}, 3.9676497405286846`*^9, {3.9676498804469624`*^9, 
   3.9676498935651054`*^9}, {3.9676502273237076`*^9, 
   3.9676502333720646`*^9}, {3.967650307322386*^9, 3.967650337213373*^9}, {
   3.967757947903244*^9, 3.9677579497218056`*^9}, {3.9677579965243816`*^9, 
   3.967758018622774*^9}, {3.9677580509970703`*^9, 3.9677580807062073`*^9}, {
   3.967758110916733*^9, 3.9677581265480175`*^9}, {3.9680844574351597`*^9, 
   3.9680844579441566`*^9}},ExpressionUUID->"bfe98629-a847-9e41-92fe-\
50acce952acb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=."}], ";"}], "\n", 
 RowBox[{
  RowBox[{"a", "=."}], ";"}], "\n", 
 RowBox[{
  RowBox[{"s", "=."}], ";"}]}], "Code",
 CellChangeTimes->{{3.9668137855829144`*^9, 
  3.966813786148487*^9}},ExpressionUUID->"468dc405-e98f-d944-9530-\
65b2f072ecc9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Code",
 CellChangeTimes->{{3.965430802027622*^9, 3.965430802027622*^9}, 
   3.965431486173973*^9, {3.9668137920153046`*^9, 
   3.9668137921150627`*^9}},ExpressionUUID->"df1742f8-e3ff-e24a-bbb8-\
d2eca0a18691"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ASRsHelp", "[", "function_Symbol", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"usage", ",", " ", "details"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"usage", "=", 
       RowBox[{"Quiet", "[", 
        RowBox[{"MessageName", "[", 
         RowBox[{"function", ",", "\"\<usage\>\""}], "]"}], "]"}]}], ";", 
      "\n", 
      RowBox[{"details", "=", 
       RowBox[{"Quiet", "[", 
        RowBox[{"MessageName", "[", 
         RowBox[{"function", ",", "\"\<details\>\""}], "]"}], "]"}]}], ";", 
      "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"StringQ", "[", "usage", "]"}], ",", "\n", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "usage", "]"}], ";", "\n", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"StringQ", "[", "details", "]"}], ",", 
            RowBox[{"Print", "[", "details", "]"}]}], "]"}], ";"}], "\n", 
         ")"}], ",", "\n", 
        RowBox[{
         RowBox[{"Print", "[", 
          
          RowBox[{"\"\<No documentation found for \>\"", ",", "function", 
           ",", "\"\<.\>\""}], "]"}], ";"}]}], "\n", "]"}], ";"}]}], "\n", 
    "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.9662841789232903`*^9, 3.9662842713772697`*^9}, {
   3.96628434337908*^9, 3.966284367443407*^9}, 3.9662844652050858`*^9, {
   3.9662846166666374`*^9, 3.966284650823759*^9}, {3.9662847277430096`*^9, 
   3.966284750118519*^9}, 3.9662849167883453`*^9, {3.966357330939247*^9, 
   3.966357336527643*^9}, {3.966813794295582*^9, 
   3.9668137943437004`*^9}},ExpressionUUID->"05555e7c-a6c2-684b-aab7-\
5668dfef0f53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$ASRsSession", "=."}], ";"}]], "Code",
 CellChangeTimes->{{3.9654273749730663`*^9, 3.965427399699991*^9}, {
   3.965427501287636*^9, 3.965427540883009*^9}, {3.965427573385994*^9, 
   3.965427574649*^9}, {3.965427817152191*^9, 3.965427825094694*^9}, {
   3.9654278806568317`*^9, 3.9654278913700447`*^9}, {3.965428057781994*^9, 
   3.9654280857157*^9}, {3.9654284415013943`*^9, 3.965428556773428*^9}, 
   3.9654287477571545`*^9, {3.9654287995370655`*^9, 3.9654288619335823`*^9}, {
   3.96542892506958*^9, 3.9654289255047417`*^9}, {3.965428958765398*^9, 
   3.965429049927452*^9}, {3.9654291596539288`*^9, 3.9654291896438313`*^9}, {
   3.9654293301555634`*^9, 3.9654295079148254`*^9}, {3.965429583507183*^9, 
   3.965429652161791*^9}, {3.9654297712931576`*^9, 3.965429793189089*^9}, {
   3.9654308686714325`*^9, 3.9654308945931664`*^9}, {3.9654311319645786`*^9, 
   3.96543114227055*^9}, {3.9654312427640457`*^9, 3.96543124351474*^9}, {
   3.965431348945015*^9, 3.9654313493049774`*^9}, {3.9654315170366154`*^9, 
   3.9654315175488605`*^9}, {3.965433336695759*^9, 3.9654333724917946`*^9}, {
   3.966813796517563*^9, 
   3.966813796578251*^9}},ExpressionUUID->"aa64c93c-fc27-6843-b787-\
24caf5262f31"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"startPythonSession", "[", 
     RowBox[{"session_", ",", "path_String"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"$ASRsSession", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"session", ",", "_ExternalSessionObject"}], "]"}], ",", 
          "session", ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"startPythonSession", "::", "nosession"}], "]"}], ";", 
           RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FileExistsQ", "[", "path", "]"}], ",", "Null", ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"startPythonSession", "::", "nofile"}], ",", "path"}], 
           "]"}], ";", 
          RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ExternalEvaluate", "[", 
        RowBox[{"$ASRsSession", ",", 
         RowBox[{"File", "[", "path", "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"startPythonSession", "::", "nosession"}], 
   "=", "\"\<No active Python session provided.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"startPythonSession", "::", "nofile"}], 
   "=", "\"\<File `1` does not exist.\>\""}], ";"}]}], "Code",
 CellChangeTimes->{
  3.965437435569935*^9, {3.966372637834591*^9, 3.96637265759219*^9}, 
   3.966372997945526*^9, {3.9666930632372456`*^9, 3.9666930670614605`*^9}, {
   3.966812045892618*^9, 3.9668120476657276`*^9}, {3.966813798563038*^9, 
   3.966813798624035*^9}},ExpressionUUID->"3b920bb5-cb45-0245-be13-\
ce3c447d075c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pyEval", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"args_", ":", 
      RowBox[{"<|", "|>"}]}]}], "]"}], ":=", 
   RowBox[{"ExternalEvaluate", "[", 
    RowBox[{"$ASRsSession", ",", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<Command\>\"", "->", "expr"}], ",", 
       RowBox[{"\"\<Arguments\>\"", "->", "args"}]}], "|>"}]}], "]"}]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.966813800668848*^9, 
  3.966813800731428*^9}},ExpressionUUID->"07bc084b-f324-2545-8e8d-\
5c83b127bf74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Extracts", " ", "amplitudes", " ", "from", " ", "Python", " ", "System", " ",
     "object"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "extractAmps", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"partVal", "->", 
       RowBox[{"{", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"extractAmps", "[", 
      RowBox[{"system_", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"amplitudes", ",", "colNames", ",", "extractParticles", ",", 
         RowBox[{"partVal", "=", 
          RowBox[{"OptionValue", "[", "partVal", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"amplitudes", "=", 
         RowBox[{"pyEval", "[", 
          RowBox[{"\"\<extract_amps\>\"", ",", "system"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"colNames", "=", 
         RowBox[{"{", 
          
          RowBox[{"\"\<Processes\>\"", ",", "\"\<QNs\>\"", 
           ",", "\"\<n-tuple\>\"", ",", "\"\<Node\>\"", 
           ",", "\"\<Binary indices\>\"", ",", "\"\<q factor\>\"", 
           ",", "\"\<p factor\>\"", ",", "\"\<mu\>\"", ",", "\"\<CG\>\""}], 
          "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"amplitudes", "=", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{"AssociationThread", "[", 
             RowBox[{"colNames", ",", "#"}], "]"}], "&"}], "]"}], "@", 
          "amplitudes"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Processes", " ", "from", " ", "particle", " ", "names"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"extractParticles", "[", 
          RowBox[{"particles_", ",", "indices_"}], "]"}], ":=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MapThread", "[", 
             RowBox[{"Part", ",", 
              RowBox[{"{", 
               RowBox[{"#1", ",", "#2"}], "}"}]}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"particles", ",", "indices"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "partVal", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"amplitudes", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "\"\<Processes\>\""}], "]"}], "]"}], "=", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"extractParticles", "[", 
                   RowBox[{"partVal", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"extractParticles", "[", 
                   RowBox[{"partVal", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}], "&"}], ",", 
               RowBox[{"amplitudes", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "\"\<Processes\>\""}], "]"}], "]"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"amplitudes", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "\"\<CKM\>\""}], "]"}], "]"}], "=", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
               RowBox[{"amplitudes", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "\"\<Processes\>\""}], "]"}], "]"}], ",", 
               RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"amplitudes", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "\"\<Processes\>\""}], "]"}], "]"}], "=", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], ",", 
               RowBox[{"amplitudes", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "\"\<Processes\>\""}], "]"}], "]"}], ",", 
               RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"amplitudes", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "\"\<Processes\>\""}], "]"}], "]"}], "=", 
             RowBox[{"Map", "[", 
              RowBox[{"StringRiffle", ",", 
               RowBox[{"amplitudes", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "\"\<Processes\>\""}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"-", "2"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"amplitudes", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "\"\<Processes\>\""}], "]"}], "]"}], "=", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"StringJoin", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< \[Rule] \>\"", 
                   ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "}"}], "&"}], ",", 
               RowBox[{"amplitudes", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "\"\<Processes\>\""}], "]"}], "]"}], ",", 
               RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"amplitudes", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "\"\<Processes\>\""}], "]"}], "]"}], "=", 
             RowBox[{"Flatten", "/@", 
              RowBox[{"amplitudes", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "\"\<Processes\>\""}], "]"}], "]"}]}]}], 
            ";"}], "\[IndentingNewLine]", ")"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"amplitudes", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"KeyDrop", "[", 
               RowBox[{"#", ",", "\"\<Processes\>\""}], "]"}], "&"}], "/@", 
             "amplitudes"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"amplitudes", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<QNs\>\""}], "]"}], "]"}], "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", ">", "0"}], ",", 
              RowBox[{"\"\<+\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{
                 RowBox[{"Rationalize", "[", "#", "]"}], ",", 
                 "StandardForm"}], "]"}]}], ",", 
              RowBox[{"ToString", "[", 
               RowBox[{
                RowBox[{"Rationalize", "[", "#", "]"}], ",", "StandardForm"}],
                "]"}]}], "]"}], "&"}], ",", 
           RowBox[{"amplitudes", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "\"\<QNs\>\""}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"-", "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"amplitudes", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<QNs\>\""}], "]"}], "]"}], "=", 
         RowBox[{"Map", "[", 
          RowBox[{"StringRiffle", ",", 
           RowBox[{"amplitudes", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "\"\<QNs\>\""}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"-", "2"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"amplitudes", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<QNs\>\""}], "]"}], "]"}], "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"StringJoin", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"ToString", "[", 
                RowBox[{
                 RowBox[{"Overscript", "[", 
                  RowBox[{"\"\< \[Rule] \>\"", ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                 "StandardForm"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "}"}], "&"}], ",", 
           RowBox[{"amplitudes", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "\"\<QNs\>\""}], "]"}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"amplitudes", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<QNs\>\""}], "]"}], "]"}], "=", 
         RowBox[{"Flatten", "/@", 
          RowBox[{"amplitudes", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "\"\<QNs\>\""}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"amplitudes", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<mu\>\""}], "]"}], "]"}], "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Sqrt", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "&"}], ",", 
           RowBox[{"amplitudes", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "\"\<mu\>\""}], "]"}], "]"}]}], "]"}]}], ";",
         " ", 
        RowBox[{"(*", " ", 
         RowBox[{"mu", " ", "factors"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"amplitudes", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<CG\>\""}], "]"}], "]"}], "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ClebschGordan", "@@", 
             RowBox[{"Rationalize", "[", "#", "]"}]}], "&"}], ",", 
           RowBox[{"amplitudes", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "\"\<CG\>\""}], "]"}], "]"}]}], "]"}]}], ";",
         " ", 
        RowBox[{"(*", " ", 
         RowBox[{"CG", " ", "coeffs", " ", "from", " ", "symmetrization"}], 
         " ", "*)"}], "\[IndentingNewLine]", "amplitudes"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.966371965137396*^9, 3.9663719781971264`*^9}, {
   3.9663721202065563`*^9, 3.9663721251565247`*^9}, {3.9663721589966183`*^9, 
   3.9663721630163383`*^9}, {3.9663722029261837`*^9, 3.9663722074563885`*^9}, 
   3.966372378005415*^9, {3.966519330398857*^9, 3.966519463141737*^9}, {
   3.96669310964682*^9, 3.9666931128382034`*^9}, {3.96680505756176*^9, 
   3.966805075277052*^9}, {3.9668067601022663`*^9, 3.9668067769436855`*^9}, {
   3.966813803294628*^9, 3.9668138033317585`*^9}, {3.96688894287138*^9, 
   3.966888946145876*^9}, {3.9668889777635117`*^9, 3.9668889900924377`*^9}, {
   3.966889192245558*^9, 3.966889201619543*^9}, {3.966889571184273*^9, 
   3.9668895806036167`*^9}, 3.966889687013008*^9, {3.9668897775553017`*^9, 
   3.9668897817883396`*^9}, {3.966891848257225*^9, 3.966891857874201*^9}, {
   3.966892080599289*^9, 3.966892081763773*^9}, 3.9668929955675373`*^9, {
   3.966893101038851*^9, 3.966893132897608*^9}, {3.966893515754141*^9, 
   3.9668935210247536`*^9}, {3.9668955016056004`*^9, 3.966895503217785*^9}, {
   3.9668972842295322`*^9, 3.966897295692314*^9}, {3.9668973349985943`*^9, 
   3.966897355981825*^9}, {3.9668976135051994`*^9, 3.9668976167762585`*^9}, {
   3.966897679838812*^9, 3.9668976802434025`*^9}, {3.966897729293379*^9, 
   3.966897732471733*^9}, {3.966897832149828*^9, 3.966897842027008*^9}, {
   3.966898290793867*^9, 3.966898321219927*^9}, {3.966898542164654*^9, 
   3.9668985513901253`*^9}, {3.966898693117687*^9, 3.9668986946001225`*^9}, {
   3.9669744823656197`*^9, 3.9669744830626087`*^9}, 3.9669747796229553`*^9, 
   3.967933774898567*^9, {3.967933815708025*^9, 3.967933823580473*^9}, {
   3.967934044672655*^9, 3.96793406168589*^9}, {3.9679340931125107`*^9, 
   3.9679340934442043`*^9}, {3.9679343846200905`*^9, 3.9679344177484474`*^9}, 
   3.9679348135268707`*^9, {3.9679352638173676`*^9, 3.9679352656251945`*^9}, {
   3.967935323485405*^9, 3.967935323678591*^9}, {3.9679353569053*^9, 
   3.967935378281639*^9}, {3.9679355384554653`*^9, 3.967935540089134*^9}, {
   3.967935625894083*^9, 3.9679356504013577`*^9}, 3.96793572515662*^9, {
   3.9679358238403893`*^9, 3.9679358305267334`*^9}, {3.967935970010231*^9, 
   3.9679359710224648`*^9}, {3.9679360016446342`*^9, 3.967936009165066*^9}, {
   3.9679362188831177`*^9, 3.96793624703714*^9}, {3.9679365750404987`*^9, 
   3.9679365813305607`*^9}, {3.9679368757815323`*^9, 3.967936892052561*^9}, {
   3.9679369277319164`*^9, 3.9679369352249546`*^9}, {3.967937293035408*^9, 
   3.9679373215209007`*^9}, {3.9679374756224937`*^9, 
   3.967937484680094*^9}},ExpressionUUID->"5984c2c7-d660-8343-97c4-\
7ee157add873"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"defineSystem", "[", 
    RowBox[{"in_", ",", "h_", ",", "out_", ",", "phys_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"repSpins", ",", "reps", ",", "system", ",", "particles"}], 
      "}"}], ",", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"repSpins", "[", "list_", "]"}], ":=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"list", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "-", "1"}], ")"}], "/", 
          "2"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\n", 
      RowBox[{"If", "[", 
       RowBox[{"phys", ",", "\n", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"particles", "=", 
           RowBox[{"{", 
            RowBox[{"in", ",", "h", ",", "out"}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"reps", "=", 
           RowBox[{"Map", "[", 
            RowBox[{"repSpins", ",", "particles"}], "]"}]}], ";"}], "\n", 
         ")"}], ",", "\n", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"reps", "=", 
           RowBox[{"{", 
            RowBox[{"in", ",", "h", ",", "out"}], "}"}]}], ";", "\n", 
          RowBox[{"particles", "=", 
           RowBox[{"{", "}"}]}], ";"}], "\n", ")"}]}], "\n", "]"}], ";", "\n", 
      RowBox[{"system", "=", 
       RowBox[{"pyEval", "[", 
        RowBox[{"\"\<define_system\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"reps", ",", "phys"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"{", 
       RowBox[{"system", ",", "particles"}], "}"}]}]}], "\n", "]"}]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.9654334098345833`*^9, 3.965433410346695*^9}, {
   3.965473909608509*^9, 3.9654739365379543`*^9}, {3.9654761644054356`*^9, 
   3.9654761748442993`*^9}, {3.965476211991638*^9, 3.9654762727694874`*^9}, 
   3.9654763103803864`*^9, {3.965476355814966*^9, 3.9654765311662216`*^9}, 
   3.965476575916849*^9, {3.965476626005413*^9, 3.9654766811265945`*^9}, {
   3.965476757497919*^9, 3.965476788881382*^9}, {3.965479288624241*^9, 
   3.9654792988438816`*^9}, {3.966370746573862*^9, 3.966370752425617*^9}, {
   3.9663708134007664`*^9, 3.9663708292465687`*^9}, {3.9663708744977283`*^9, 
   3.9663708776450386`*^9}, 3.966370944229084*^9, {3.9663709827525196`*^9, 
   3.9663709984236183`*^9}, {3.966371028650572*^9, 3.966371040488106*^9}, {
   3.96681380556225*^9, 
   3.966813805614294*^9}},ExpressionUUID->"880939d3-8af6-344f-8730-\
7a3378b3ba8f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "generateASRs", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"phys", "->", "False"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"generateASRs", "[", 
    RowBox[{"in_", ",", "h_", ",", "out_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"system", ",", 
       RowBox[{"phys", "=", 
        RowBox[{"OptionValue", "[", "phys", "]"}]}], ",", "particles", ",", 
       "ASRs", ",", "amplitudes", ",", "dupPairs", ",", "factorsMat", ",", 
       "n", ",", "irreps", ",", "nAmps", ",", "nASRs"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"system", ",", "particles"}], "}"}], "=", 
       RowBox[{"defineSystem", "[", 
        RowBox[{"in", ",", "h", ",", "out", ",", "phys"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"constructs", " ", "Python", " ", "System", " ", "object"}], 
       " ", "*)"}], "\n", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"system", ",", "ASRs", ",", "dupPairs"}], "}"}], "=", 
       RowBox[{"pyEval", "[", 
        RowBox[{"\"\<generate_srs\>\"", ",", "system"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "M", " ", "values", " ", "for", " ", "symmetrized", " ", "system"}], ",",
         " ", 
        RowBox[{"contains", " ", "duplicate", " ", "amplitudes"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"amplitudes", "=", 
       RowBox[{"extractAmps", "[", "system", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"factorsMat", "=", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{
         RowBox[{"amplitudes", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<mu\>\""}], "]"}], "]"}], "*", 
         RowBox[{"amplitudes", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<CG\>\""}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ASRs", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", ".", "factorsMat"}], "&"}], ",", "ASRs"}], "]"}]}], ";",
       " ", 
      RowBox[{"(*", " ", 
       RowBox[{"SRs", " ", "for", " ", "symmetrized", " ", "system"}], " ", 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Correct", " ", "for", " ", "duplicate", " ", "amplitudes", " ", 
        "from", " ", "symmetrization"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ASRs", "[", 
           RowBox[{"[", "b", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"dupPairs", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], "+=", 
         RowBox[{
          RowBox[{"ASRs", "[", 
           RowBox[{"[", "b", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"dupPairs", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", 
          RowBox[{"Length", "[", "ASRs", "]"}]}], "}"}]}], "]"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "adds", " ", "together", " ", "cols", " ", "of", " ", "duplicate", " ",
         "amp", " ", "pairs"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ASRs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"Delete", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", "#", "]"}], ",", 
            RowBox[{"List", "/@", 
             RowBox[{"dupPairs", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}], "]"}], 
         "&"}], "/@", "ASRs"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"deletes", " ", "duplicate", " ", "cols"}], " ", "*)"}], "\n", 
      RowBox[{"system", "=", 
       RowBox[{"pyEval", "[", 
        RowBox[{"\"\<remove_dups\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"system", ",", "dupPairs"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"amplitudes", "=", 
       RowBox[{"extractAmps", "[", 
        RowBox[{"system", ",", 
         RowBox[{"partVal", "->", "particles"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ASRs", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"Except", "@", 
           RowBox[{"{", 
            RowBox[{"0", ".."}], "}"}]}], "]"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{"RowReduce", ",", "ASRs"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "irreps"}], "}"}], "=", 
       RowBox[{"pyEval", "[", 
        RowBox[{"\"\<extract_sys\>\"", ",", "system"}], "]"}]}], ";", "\n", 
      RowBox[{"nAmps", "=", 
       RowBox[{"numAmps", "[", "amplitudes", "]"}]}], ";", "\n", 
      RowBox[{"nASRs", "=", 
       RowBox[{"numASRs", "[", "ASRs", "]"}]}], ";", "\n", 
      RowBox[{"system", "=", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<n doublets\>\"", "->", "n"}], ",", 
         RowBox[{"\"\<Irreps\>\"", "->", "irreps"}], ",", 
         RowBox[{"\"\<n amps\>\"", "->", "nAmps"}], ",", 
         RowBox[{"\"\<Amplitudes\>\"", "->", "amplitudes"}], ",", 
         RowBox[{"\"\<n ASRs\>\"", "->", "nASRs"}], ",", 
         RowBox[{"\"\<ASRs\>\"", "->", "ASRs"}]}], "|>"}]}], ";", "\n", "\n", 
      "system"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.96547339632358*^9, 3.965473424966324*^9}, 
   3.965473678537565*^9, {3.9663704810984497`*^9, 3.9663705740647907`*^9}, {
   3.9663706340511837`*^9, 3.966370655744219*^9}, {3.9663707239872284`*^9, 
   3.9663707560279446`*^9}, {3.9663710994210873`*^9, 3.966371192964012*^9}, {
   3.96637123630064*^9, 3.9663712457140636`*^9}, {3.9663712778640347`*^9, 
   3.96637127855542*^9}, {3.9663713360718555`*^9, 3.9663713463890114`*^9}, {
   3.9663721124367485`*^9, 3.966372113732992*^9}, {3.9663721968963375`*^9, 
   3.966372197363901*^9}, 3.9663739876695786`*^9, {3.966375294862892*^9, 
   3.9663753263727226`*^9}, {3.966375369982132*^9, 3.966375390622326*^9}, {
   3.9663754752416916`*^9, 3.9663755260716343`*^9}, {3.966376166493292*^9, 
   3.966376176514143*^9}, {3.966813808118252*^9, 3.966813808158779*^9}, {
   3.966892451289791*^9, 3.9668924624586487`*^9}, {3.9668927060052357`*^9, 
   3.9668927070370502`*^9}, {3.966974491341345*^9, 
   3.966974499108799*^9}},ExpressionUUID->"b8f38615-5711-ca47-ad73-\
f311a43e531b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Returns", " ", "the", " ", "total", " ", "number", " ", "of", " ", 
    "amplitudes", " ", "in", " ", "the", " ", "system"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"numAmps", "[", 
     RowBox[{"amplitudes_", ",", 
      RowBox[{"nPairs_", ":", "False"}]}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", "nPairs"}], ",", 
      RowBox[{"Length", "@", 
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"Flatten", "@", 
         RowBox[{"amplitudes", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<Binary indices\>\""}], "]"}], "]"}]}]}]}],
       ",", 
      RowBox[{"Length", "@", 
       RowBox[{"Flatten", "@", 
        RowBox[{"amplitudes", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "\"\<Node\>\""}], "]"}], "]"}]}]}]}], "]"}]}], 
   ";"}]}]], "Code",
 CellChangeTimes->{{3.966376669886526*^9, 3.966376674456522*^9}, {
   3.966813811354227*^9, 3.966813811426607*^9}, {3.966901789977337*^9, 
   3.966901888001793*^9}, {3.9669019631733913`*^9, 3.9669019693521004`*^9}, {
   3.9669020000011883`*^9, 3.966902030094076*^9}, {3.9669028160293427`*^9, 
   3.966902818963228*^9}, 3.9669031137220573`*^9, {3.966952966384054*^9, 
   3.9669529692871323`*^9}, {3.966955642612261*^9, 
   3.9669556467663593`*^9}},ExpressionUUID->"e76c6bd5-7ca7-904b-9202-\
4c539d870962"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Adds", " ", "a", " ", "column", " ", "to", " ", "amplitudes"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"labelAmps", ",", "HoldFirst"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "labelAmps", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"labeling", "->", "\"\<Amplitudes\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"labelAmps", "[", 
      RowBox[{"amplitudes_", ",", "colName_String", ",", "labels_List", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pairs", ",", "nAmps", ",", "labelVals", ",", 
         RowBox[{"labeling", "=", 
          RowBox[{"OptionValue", "[", "labeling", "]"}]}], ",", "indices", ",",
          "labelIndices"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pairs", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"labeling", "==", "\"\<Amplitudes\>\""}], ",", "False", ",",
            "True"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nAmps", "=", 
         RowBox[{"numAmps", "[", 
          RowBox[{"amplitudes", ",", "pairs"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nAmps", "==", 
           RowBox[{"Length", "@", 
            RowBox[{"Flatten", "[", "labels", "]"}]}]}], ",", "Null", ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"labelAmps", "::", "arglen"}], ",", "labels", ",", 
             "nAmps", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"Flatten", "[", "labels", "]"}]}]}], "]"}], ";", 
           RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"labelVals", "=", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"labeling", "==", "\"\<Amplitude pairs\>\""}], ",", 
           "\[IndentingNewLine]", "labels", ",", "\[IndentingNewLine]", 
           RowBox[{"labeling", "==", "\"\<Amplitudes\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"indices", "=", 
              RowBox[{"amplitudes", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "\"\<Binary indices\>\""}], "]"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"labelIndices", "=", 
              RowBox[{"Sort", "[", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Range", "[", "nAmps", "]"}], ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"indices", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "==", 
                    RowBox[{"indices", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"2", "*", "i"}], "-", "1"}], ",", "Nothing"}], 
                    "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "indices", "]"}]}], "}"}]}], 
                  "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Partition", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Flatten", "[", "labels", "]"}], "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "labelIndices"}], "}"}]}], "]"}], ",", 
               "2"}], "]"}]}], "\[IndentingNewLine]", ")"}], ",", 
           "\[IndentingNewLine]", "True", ",", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{"labelAmps", "::", "badmode"}], ",", "labeling"}], 
             "]"}], ";", 
            RowBox[{"Return", "[", "$Failed", "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"amplitudes", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Prepend", ",", 
           RowBox[{"{", 
            RowBox[{"amplitudes", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"colName", "->", "#"}], "&"}], "/@", "labelVals"}]}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "amplitudes"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"labelAmps", "::", "arglen"}], 
     "=", "\"\<The argument supplied to `1` has an incorrect number of \
labels. Expected `2` labels, got `3`. Check that the labeling option is \
correct.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"labelAmps", "::", "badmode"}], 
     "=", "\"\<Unknown labeling mode `1`. Use \\\"Amplitudes\\\" or \
\\\"Amplitude pairs\\\".\>\""}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.9669011887202015`*^9, 3.9669012745156174`*^9}, {
   3.9669013323251762`*^9, 3.9669013815587673`*^9}, {3.966901473106659*^9, 
   3.9669015442741356`*^9}, {3.9669016218463593`*^9, 
   3.9669016334134674`*^9}, {3.96690166947591*^9, 3.966901678282295*^9}, {
   3.9669020585554924`*^9, 3.966902318599533*^9}, {3.966902622136856*^9, 
   3.9669027424117165`*^9}, {3.9669027884671783`*^9, 3.9669027959495544`*^9}, 
   3.966902840748457*^9, {3.9669029957354965`*^9, 3.966903079257332*^9}, {
   3.966903205769722*^9, 3.966903230495531*^9}, {3.9669033024366474`*^9, 
   3.966903322390459*^9}, {3.966903390485405*^9, 3.966903411063265*^9}, 
   3.96695312525581*^9, {3.966955017767254*^9, 3.966955018765972*^9}, {
   3.9669553451994915`*^9, 3.9669554196789246`*^9}, {3.966955494625044*^9, 
   3.96695550607687*^9}, {3.966955597892025*^9, 3.966955612410656*^9}, {
   3.966955758086376*^9, 3.966955787286808*^9}, {3.9669558836779423`*^9, 
   3.9669559251420517`*^9}, {3.96695613230698*^9, 3.9669561921305428`*^9}, {
   3.966956241326475*^9, 3.966956265224781*^9}, {3.966956326843004*^9, 
   3.966956365162483*^9}, {3.966956834394188*^9, 3.966956834592417*^9}, {
   3.967939117803978*^9, 3.9679391283259315`*^9}, {3.967939215195753*^9, 
   3.96793921721492*^9}, {3.967939250097229*^9, 3.967939351048212*^9}, {
   3.9679395553058624`*^9, 3.9679395816748314`*^9}, {3.967939623699623*^9, 
   3.967939624160284*^9}, {3.9679397197061367`*^9, 3.96793974954459*^9}, {
   3.967939855255953*^9, 3.9679399635558147`*^9}, {3.9679401929450874`*^9, 
   3.9679402134845467`*^9}, {3.967940276457573*^9, 3.9679402929658184`*^9}, {
   3.9679403873083363`*^9, 3.9679403898033466`*^9}, {3.9679406651207104`*^9, 
   3.9679406693352604`*^9}, {3.9679408275030174`*^9, 
   3.9679408632338696`*^9}, {3.967940894590847*^9, 3.9679409316479607`*^9}, {
   3.9679409920645103`*^9, 3.9679409936386414`*^9}, {3.967941032286825*^9, 
   3.96794107097394*^9}, 3.967941201933573*^9, {3.9679413166646957`*^9, 
   3.967941317342064*^9}, {3.9679414565456734`*^9, 3.967941458036749*^9}, {
   3.9679415086195316`*^9, 3.967941512173811*^9}, {3.967941757223402*^9, 
   3.9679418003878307`*^9}, 3.967941832148531*^9, 3.967941870736952*^9, {
   3.9679419093570385`*^9, 3.967941910282364*^9}, {3.9679424942737217`*^9, 
   3.967942537129444*^9}, {3.967942657477951*^9, 
   3.967942659331072*^9}},ExpressionUUID->"d3f0884b-1669-1d49-8918-\
ef4b8bcf66e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Removes", " ", "columns", " ", "from", " ", "amplitudes"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"unlabelAmps", ",", "HoldFirst"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"unlabelAmps", "[", 
      RowBox[{"amplitudes_", ",", "colNames_"}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{"amplitudes", "=", 
       RowBox[{
        RowBox[{"KeyDrop", "[", "colNames", "]"}], "/@", "amplitudes"}]}], 
      ")"}]}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.9669573106874504`*^9, 3.9669573841516323`*^9}, {
   3.9669574352489853`*^9, 3.966957451258032*^9}, 
   3.966957857186838*^9},ExpressionUUID->"6b6e045b-b322-8a42-a08a-\
b172d08b7c58"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Prints", " ", "a", " ", "table", " ", "of", " ", "amplitudes"}], 
   " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "printAmps", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"showFactors", "->", "False"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"printAmps", "[", 
      RowBox[{"amplitudes_", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"amplitudesVal", "=", "amplitudes"}], ",", "indices", ",", 
         "selfConj", ",", "nAmps", ",", 
         RowBox[{"showFactors", "=", 
          RowBox[{"OptionValue", "[", "showFactors", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Delete", " ", "self"}], "-", 
         RowBox[{
         "conjugate", " ", "duplicate", " ", "values", " ", "from", " ", 
          "display"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"indices", "=", 
         RowBox[{"amplitudesVal", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<Binary indices\>\""}], "]"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"selfConj", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"indices", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "==", 
              RowBox[{"indices", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", "i", ",", 
             "Nothing"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "indices", "]"}]}], "}"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"amplitudesVal", "[", 
          RowBox[{"[", "selfConj", "]"}], "]"}], "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"ListQ", "[", "#", "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"amplitudesVal", "[", 
            RowBox[{"[", "selfConj", "]"}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"nAmps", "=", 
         RowBox[{"numAmps", "[", "amplitudesVal", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", "showFactors"}], ",", 
          RowBox[{"amplitudesVal", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                
                RowBox[{"\"\<Binary indices\>\"", ",", "\"\<q factor\>\"", 
                 ",", "\"\<p factor\>\"", ",", "\"\<mu\>\"", 
                 ",", "\"\<CG\>\""}], "}"}]}], "]"}], "&"}], "/@", 
            "amplitudesVal"}]}], ",", "Null"}], "]"}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"show", "/", "hide"}], " ", "internal", " ", "factors", " ",
           "from", " ", "display"}], " ", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Amplitude table\>\"", ",", "\"\<\\n\>\"", ",", 
          "\[IndentingNewLine]", "\"\<Number of amplitudes: \>\"", ",", 
          "nAmps", ",", "\"\<\\n\>\"", ",", "\[IndentingNewLine]", 
          RowBox[{"TableForm", "[", 
           RowBox[{"Prepend", "[", 
            RowBox[{
             RowBox[{"Values", "/@", "amplitudesVal"}], ",", 
             RowBox[{"Keys", "[", 
              RowBox[{"amplitudesVal", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.965473432596567*^9, 3.9654734550842705`*^9}, {
   3.966372443323105*^9, 3.9663725008557014`*^9}, 3.9663761586788464`*^9, {
   3.966376726360489*^9, 3.9663767323160954`*^9}, {3.9668097642557697`*^9, 
   3.9668097822690544`*^9}, {3.9668098301751003`*^9, 
   3.9668098327106647`*^9}, {3.966810667517948*^9, 3.966810703217697*^9}, {
   3.966810748288763*^9, 3.9668108567957287`*^9}, 3.966810921950199*^9, {
   3.9668109692300396`*^9, 3.96681098537603*^9}, {3.966811018593855*^9, 
   3.9668110276720943`*^9}, {3.9668110589644375`*^9, 
   3.9668110658050404`*^9}, {3.9668111883958797`*^9, 
   3.9668111891475086`*^9}, {3.9668138142225266`*^9, 
   3.9668138142769833`*^9}, {3.966864415563225*^9, 3.966864464205868*^9}, {
   3.9668659147146835`*^9, 3.9668659248793316`*^9}, {3.966865983069517*^9, 
   3.9668659953338375`*^9}, {3.9668660518787994`*^9, 
   3.9668660671755333`*^9}, {3.9668669159724026`*^9, 
   3.9668669185225735`*^9}, {3.966867684012005*^9, 3.966867689479477*^9}, {
   3.96686784283354*^9, 3.966867857724476*^9}, {3.9668679391665707`*^9, 
   3.966867944059353*^9}, {3.9668684989058723`*^9, 3.9668685061889515`*^9}, {
   3.967938593343418*^9, 3.967938596031847*^9}, {3.9679386282741585`*^9, 
   3.967938635095724*^9}, {3.9679426853595257`*^9, 3.9679426999136257`*^9}, {
   3.967942834203493*^9, 3.9679428517861404`*^9}, {3.9679429450360413`*^9, 
   3.967942975317333*^9}, {3.96794301118939*^9, 3.96794303320422*^9}, {
   3.9679431232647533`*^9, 3.9679431423638477`*^9}, {3.9679434044269505`*^9, 
   3.9679434430816135`*^9}, {3.967943473249483*^9, 3.9679435484448376`*^9}, {
   3.967944325729889*^9, 
   3.9679443264299145`*^9}},ExpressionUUID->"652dbf7d-bb33-d140-b908-\
715ec4001dc0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Returns", " ", "a", " ", "list", " ", "of", " ", "the", " ", "orders", " ",
     "of", " ", "breaking"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"listbOrders", "[", 
    RowBox[{"b_", ",", "nOrders_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"bVal", "=", "b"}], ",", "bList"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bVal", "=", 
       RowBox[{"b", "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i_", ",", "j_", ",", 
             RowBox[{"k_", ":", "1"}]}], "}"}], ":>", 
           RowBox[{"Span", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Replace", "[", 
              RowBox[{"i", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Null", "->", "1"}], ",", 
                 RowBox[{"x_Integer", ":>", 
                  RowBox[{"x", "+", "1"}]}]}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Replace", "[", 
              RowBox[{"j", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Null", "->", "All"}], ",", 
                 RowBox[{"x_Integer", ":>", 
                  RowBox[{"x", "+", "1"}]}]}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", "k"}], "\[IndentingNewLine]", "]"}]}], ",",
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "i_", "}"}], ":>", 
           RowBox[{"Span", "[", 
            RowBox[{
             RowBox[{"Replace", "[", 
              RowBox[{"i", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Null", "->", "1"}], ",", 
                 RowBox[{"x_Integer", ":>", 
                  RowBox[{"x", "+", "1"}]}]}], "}"}]}], "]"}], ",", "All"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"i_Integer", ":>", 
           RowBox[{"Span", "[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", 
             RowBox[{"i", "+", "1"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"All", ":>", "All"}]}], "\[IndentingNewLine]", "}"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"bList", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Range", "[", "nOrders", "]"}], "-", "1"}], ")"}], "[", 
          RowBox[{"[", "bVal", "]"}], "]"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "bList"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Code",
 CellChangeTimes->{{3.9680843361117973`*^9, 3.968084370695961*^9}, {
  3.9680846370932255`*^9, 3.9680846471375523`*^9}, {3.9680846908460217`*^9, 
  3.9680847203702927`*^9}, {3.9680847780272846`*^9, 3.968084797187502*^9}, {
  3.9680849067398987`*^9, 3.9680849133352547`*^9}, {3.9680851900774937`*^9, 
  3.9680851944428196`*^9}, {3.968086275872921*^9, 
  3.96808635410203*^9}},ExpressionUUID->"835ed265-edbd-0343-ac5a-\
5fe68b21eabd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Returns", " ", "the", " ", "number", " ", "of", " ", "amplitude", " ", 
    "sum", " ", "rules", " ", "at", " ", "each", " ", "order", " ", "of", " ",
     "breaking"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "numASRs", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"b", "->", "All"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"numASRs", "[", 
      RowBox[{"ASRs_", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"b", "=", 
          RowBox[{"OptionValue", "[", "b", "]"}]}], ",", "indices", ",", 
         "sublist"}], "}"}], ",", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"b", "===", "All"}], ",", "\n", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"sublist", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "sublist", "]"}]}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"indices", "=", 
            RowBox[{
             RowBox[{"listbOrders", "[", 
              RowBox[{"b", ",", 
               RowBox[{"Length", "[", "ASRs", "]"}]}], "]"}], "+", "1"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"sublist", "=", 
            RowBox[{"ASRs", "[", 
             RowBox[{"[", "indices", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"sublist", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "sublist", "]"}]}], "}"}]}], "]"}]}], 
          ")"}]}], "\n", "]"}]}], "\n", "]"}]}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.9663766908571625`*^9, 3.966376704246441*^9}, {
  3.966813816656307*^9, 3.9668138167347527`*^9}, {3.968085491120842*^9, 
  3.968085592384865*^9}, {3.968085670014969*^9, 3.968085719030201*^9}, {
  3.9680858250102997`*^9, 3.9680858257356396`*^9}, {3.96808601767914*^9, 
  3.96808603585618*^9}, {3.968153418629385*^9, 3.968153430301914*^9}, {
  3.968153613214527*^9, 
  3.9681536553550434`*^9}},ExpressionUUID->"ddaa38d6-bebf-664b-b090-\
3c7a18bc0853"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Prints", " ", "amplitude", " ", "sum", " ", "rules", " ", "at", " ", 
    "each", " ", "order", " ", "of", " ", "breaking"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "printASRs", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"showASRs", "->", "True"}], ",", 
       RowBox[{"takeProd", "->", "True"}], ",", 
       RowBox[{"ampFormat", "->", "\"\<a/s n-tuple\>\""}], ",", 
       RowBox[{"CKM", "->", "False"}], ",", 
       RowBox[{"b", "->", "All"}]}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"printASRs", "[", 
      RowBox[{"ASRs_", ",", "amplitudes_", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"showASRs", "=", 
          RowBox[{"OptionValue", "[", "showASRs", "]"}]}], ",", 
         RowBox[{"takeProd", "=", 
          RowBox[{"OptionValue", "[", "takeProd", "]"}]}], ",", 
         RowBox[{"ampFormat", "=", 
          RowBox[{"OptionValue", "[", "ampFormat", "]"}]}], ",", 
         RowBox[{"CKM", "=", 
          RowBox[{"OptionValue", "[", "CKM", "]"}]}], ",", 
         RowBox[{"b", "=", 
          RowBox[{"OptionValue", "[", "b", "]"}]}], ",", "physicalAmps", ",", 
         "ampsToVector", ",", "ampVector", ",", "writtenASRs", ",", "bList", ",",
          "numASRsList", ",", "matForm", ",", "rule"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"physicalAmps", "[", 
          RowBox[{"amp_", ",", "asType_", ",", "col_", ",", "CKM_"}], "]"}], ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"asSign", ",", "CKMfactors"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"asSign", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"SymbolName", "[", "asType", "]"}], 
                "==", "\"\<a\>\""}], ",", 
               RowBox[{"-", "1"}], ",", 
               RowBox[{"+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"CKMfactors", "=", 
             RowBox[{"If", "[", 
              RowBox[{"CKM", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"amp", "[", 
                  RowBox[{"[", 
                   RowBox[{"\"\<CKM\>\"", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"amp", "[", 
                  RowBox[{"[", 
                   RowBox[{"\"\<CKM\>\"", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"amp", "[", 
              RowBox[{"[", "\"\<q factor\>\"", "]"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"A", "[", 
                 RowBox[{"amp", "[", 
                  RowBox[{"[", 
                   RowBox[{"col", ",", "1"}], "]"}], "]"}], "]"}], "/", 
                RowBox[{"CKMfactors", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "+", 
               RowBox[{"asSign", "*", 
                RowBox[{"amp", "[", 
                 RowBox[{"[", "\"\<p factor\>\"", "]"}], "]"}], "*", 
                RowBox[{
                 RowBox[{"A", "[", 
                  RowBox[{"amp", "[", 
                   RowBox[{"[", 
                    RowBox[{"col", ",", "2"}], "]"}], "]"}], "]"}], "/", 
                 RowBox[{"CKMfactors", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}]}], ")"}]}]}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ampsToVector", "[", 
          RowBox[{"amps_", ",", "asType_", ",", "ampFormat_", ",", "CKM_"}], 
          "]"}], ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"vector", ",", "x", ",", "label"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ampFormat", "==", "\"\<A physical\>\""}], "&&", 
               RowBox[{"!", 
                RowBox[{"KeyExistsQ", "[", 
                 RowBox[{
                  RowBox[{"amps", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Processes\>\""}],
                  "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"Message", "[", 
                RowBox[{"printASRs", "::", "invalidformat"}], "]"}], ";", 
               RowBox[{"Return", "[", "$Failed", "]"}]}], ",", "Null"}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "label"}], "}"}], "=", 
             RowBox[{"StringSplit", "[", 
              RowBox[{"ampFormat", ",", "WhitespaceCharacter", ",", "2"}], 
              "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"vector", "=", 
             RowBox[{"Switch", "[", 
              RowBox[{
              "ampFormat", ",", "\[IndentingNewLine]", "\"\<a/s n-tuple\>\"", 
               ",", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"asType", "[", "#", "]"}], "&"}], ",", 
                 RowBox[{"amps", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "\"\<n-tuple\>\""}], "]"}], "]"}]}], 
                "]"}], ",", " ", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"a", "/", "s"}], "-", 
                  RowBox[{"type", " ", "amps", " ", "with", " ", "n"}], "-", 
                  "tuples"}], ";", " ", 
                 RowBox[{"default", " ", "option"}]}], " ", "*)"}], 
               "\[IndentingNewLine]", "\"\<a/s nodes\>\"", ",", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"asType", "[", "#", "]"}], "&"}], ",", 
                 RowBox[{"amps", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "\"\<Node\>\""}], "]"}], "]"}]}], 
                "]"}], ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"a", "/", "s"}], "-", 
                 RowBox[{"type", " ", "amps", " ", "with", " ", "nodes"}]}], 
                "*)"}], "\[IndentingNewLine]", "\"\<a/s indices\>\"", ",", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"asType", "[", "#", "]"}], "&"}], ",", 
                 RowBox[{"amps", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "\"\<Binary indices\>\"", ",", "1"}], 
                   "]"}], "]"}]}], "]"}], ",", " ", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{"a", "/", "s"}], "-", 
                 RowBox[{
                 "type", " ", "amps", " ", "with", " ", "numbered", " ", 
                  "subscripts"}]}], " ", "*)"}], 
               "\[IndentingNewLine]", "\"\<A physical\>\"", ",", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"physicalAmps", "[", 
                   RowBox[{
                   "#", ",", "asType", ",", "\"\<Processes\>\"", ",", "CKM"}],
                    "]"}], "&"}], ",", "amps"}], "]"}], ",", " ", 
               RowBox[{"(*", " ", 
                RowBox[{
                "A", " ", "amps", " ", "with", " ", "physical", " ", 
                 "processes"}], " ", "*)"}], 
               "\[IndentingNewLine]", "\"\<A QNs\>\"", ",", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"physicalAmps", "[", 
                   RowBox[{
                   "#", ",", "asType", ",", "\"\<QNs\>\"", ",", "CKM"}], 
                   "]"}], "&"}], ",", "amps"}], "]"}], ",", " ", 
               RowBox[{"(*", " ", 
                RowBox[{"A", " ", "amps", " ", "with", " ", "QNs"}], " ", 
                "*)"}], "\[IndentingNewLine]", "\"\<A indices\>\"", ",", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"physicalAmps", "[", 
                   RowBox[{
                   "#", ",", "asType", ",", "\"\<Binary indices\>\"", ",", 
                    "CKM"}], "]"}], "&"}], ",", "amps"}], "]"}], ",", " ", 
               RowBox[{"(*", " ", 
                RowBox[{
                "A", " ", "amps", " ", "with", " ", "numbered", " ", 
                 "subscripts"}], " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{"_String", "/;", 
                RowBox[{"KeyExistsQ", "[", 
                 RowBox[{
                  RowBox[{"amplitudes", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "label"}], "]"}]}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"x", "==", "\"\<a/s\>\""}], ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"asType", "[", "#", "]"}], "&"}], ",", 
                   RowBox[{"amps", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "label"}], "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"physicalAmps", "[", 
                    RowBox[{"#", ",", "asType", ",", "label", ",", "CKM"}], 
                    "]"}], "&"}], ",", "amps"}], "]"}]}], "]"}], ",", " ", 
               RowBox[{"(*", " ", 
                RowBox[{"custom", " ", "amplitude", " ", "format"}], " ", 
                "*)"}], "\[IndentingNewLine]", "_", ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Message", "[", 
                  RowBox[{"printASRs", "::", "invalidformat"}], "]"}], ";", 
                 RowBox[{"Return", "[", "$Failed", "]"}]}], ")"}]}], 
              "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
            "vector"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ampVector", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ampsToVector", "[", 
            RowBox[{"amplitudes", ",", "a", ",", "ampFormat", ",", "CKM"}], 
            "]"}], ",", 
           RowBox[{"ampsToVector", "[", 
            RowBox[{"amplitudes", ",", "s", ",", "ampFormat", ",", "CKM"}], 
            "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"writtenASRs", "=", 
         RowBox[{"If", "[", 
          RowBox[{"takeProd", ",", "\[IndentingNewLine]", 
           RowBox[{"MapIndexed", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"OddQ", "[", 
                 RowBox[{"First", "[", "#2", "]"}], "]"}], ",", 
                RowBox[{"#1", ".", 
                 RowBox[{"ampVector", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{"#1", ".", 
                 RowBox[{"ampVector", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "&"}], ",", 
             "ASRs"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"MapIndexed", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"OddQ", "[", 
                 RowBox[{"First", "[", "#2", "]"}], "]"}], ",", 
                RowBox[{"Prepend", "[", 
                 RowBox[{"#1", ",", 
                  RowBox[{"ampVector", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"Prepend", "[", 
                 RowBox[{"#1", ",", 
                  RowBox[{"ampVector", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], "&"}], ",",
              "ASRs"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Cosmetics", " ", "for", " ", "printing"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"bList", "=", 
         RowBox[{"listbOrders", "[", 
          RowBox[{"b", ",", 
           RowBox[{"Length", "[", "ASRs", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"numASRsList", "=", 
         RowBox[{
          RowBox[{"numASRs", "[", "ASRs", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"bList", "+", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"matForm", ":=", 
         RowBox[{"If", "[", 
          RowBox[{"takeProd", ",", 
           RowBox[{
            RowBox[{"MatrixForm", "[", "#", "]"}], "&"}], ",", 
           RowBox[{
            RowBox[{"MatrixForm", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"2", ";;"}], "]"}], "]"}], ",", 
              RowBox[{"TableHeadings", "->", 
               RowBox[{"{", 
                RowBox[{"None", ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}]}], "]"}], "&"}]}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rule", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ampFormat", "==", "\"\<A physical\>\""}], "||", 
            RowBox[{"ampFormat", "==", "\"\<A QNs\>\""}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"x_Symbol", "[", "i_", "]"}], "/;", 
             RowBox[{"x", "=!=", "List"}]}], ":>", 
            RowBox[{"StringJoin", "[", 
             RowBox[{
              RowBox[{"ToString", "[", "x", "]"}], ",", "\"\<(\>\"", ",", "i",
               ",", "\"\<)\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"x_Symbol", "[", "i_", "]"}], "/;", 
             RowBox[{"x", "=!=", "List"}]}], ":>", 
            RowBox[{"Subscript", "[", 
             RowBox[{"x", ",", "i"}], "]"}]}]}], "\[IndentingNewLine]", 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"showASRs", ",", "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<Sum rules\>\"", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"\"\<b = \>\"", ",", 
                 RowBox[{"bList", "[", 
                  RowBox[{"[", 
                   RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], 
                 ",", "\"\<\\n\>\"", ",", 
                 "\[IndentingNewLine]", "\"\<Number of ASRs: \>\"", ",", 
                 RowBox[{"numASRsList", "[", 
                  RowBox[{"[", 
                   RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], 
                 ",", "\"\<\\n\>\"", ",", "\[IndentingNewLine]", 
                 RowBox[{"matForm", "@", 
                  RowBox[{"If", "[", 
                   RowBox[{"takeProd", ",", 
                    RowBox[{"#1", "/.", "rule"}], ",", 
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{"#1", ",", 
                    RowBox[{"1", "->", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/.", "rule"}], ")"}]}]}],
                     "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], "&"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"writtenASRs", "[", 
               RowBox[{"[", 
                RowBox[{"bList", "+", "1"}], "]"}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
           ")"}], ",", "\[IndentingNewLine]", "Null"}], "\[IndentingNewLine]",
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "writtenASRs"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"printASRs", "::", "invalidformat"}], 
     "=", "\"\<Invalid amplitude format for this system.\>\""}], 
    ";"}]}]}]], "Code",
 CellChangeTimes->{
  3.966814446295027*^9, {3.966868542602186*^9, 3.9668686126344547`*^9}, {
   3.9668704787549*^9, 3.9668705324335804`*^9}, {3.966870565203169*^9, 
   3.9668705695216465`*^9}, {3.966870649234516*^9, 3.966870650822443*^9}, {
   3.9668707929334164`*^9, 3.9668707932133865`*^9}, {3.966870914463564*^9, 
   3.9668709502375107`*^9}, {3.9668709886255856`*^9, 3.966871064151348*^9}, {
   3.9668711555424004`*^9, 3.966871211417864*^9}, {3.9668713234837112`*^9, 
   3.9668713237269287`*^9}, {3.9668715690460377`*^9, 3.966871572953102*^9}, {
   3.9668902380337963`*^9, 3.9668903609955616`*^9}, {3.9668903983527737`*^9, 
   3.966890446539484*^9}, {3.9668905136448994`*^9, 3.9668905141599445`*^9}, {
   3.966898934546919*^9, 3.966898942086973*^9}, {3.966898978761242*^9, 
   3.9668989845270023`*^9}, {3.966899064399065*^9, 3.9668990896163216`*^9}, {
   3.966902308410652*^9, 3.966902308584013*^9}, {3.9669036066706753`*^9, 
   3.9669037002361164`*^9}, {3.9669037480889797`*^9, 3.966903748464445*^9}, {
   3.9669038783794765`*^9, 3.966903884511999*^9}, {3.9669040230467587`*^9, 
   3.9669040257275143`*^9}, {3.966950317661804*^9, 3.966950347980421*^9}, {
   3.9669503971814175`*^9, 3.966950414860527*^9}, {3.9669504520751553`*^9, 
   3.966950471949354*^9}, {3.966950584393955*^9, 3.966950591171255*^9}, {
   3.966950800040674*^9, 3.966950925253769*^9}, {3.966951051220068*^9, 
   3.9669511081589737`*^9}, {3.96695118680871*^9, 3.9669512189652233`*^9}, {
   3.966951253506544*^9, 3.9669512877654343`*^9}, {3.9669513377794456`*^9, 
   3.966951365680378*^9}, {3.966951503040987*^9, 3.9669515031716824`*^9}, {
   3.966954266986515*^9, 3.9669542812071285`*^9}, {3.9680797516631985`*^9, 
   3.9680797548875885`*^9}, {3.9680798063105927`*^9, 
   3.9680799847927055`*^9}, {3.9680800322335186`*^9, 3.968080073480961*^9}, {
   3.9680801734966087`*^9, 3.968080249647846*^9}, 3.968080309701292*^9, {
   3.968080345145111*^9, 3.968080446223667*^9}, {3.968080508081396*^9, 
   3.968080705009844*^9}, {3.968084878330307*^9, 3.9680848905691376`*^9}, {
   3.9680854046559296`*^9, 3.9680854206782055`*^9}, {3.9681514466234455`*^9, 
   3.968151447121338*^9}, {3.968151480155218*^9, 3.968151480321663*^9}, {
   3.968152115313633*^9, 3.968152122443516*^9}, {3.968152183643421*^9, 
   3.9681521889550667`*^9}},ExpressionUUID->"8fb53ad9-48f1-744a-a398-\
94d20fa92c0f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"printSystem", ",", "HoldFirst"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "printSystem", "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"showReps", "->", "True"}], ",", 
       RowBox[{"showAmps", "->", "True"}]}], "}"}], ",", 
     RowBox[{"Options", "[", "printAmps", "]"}], ",", 
     RowBox[{"Options", "[", "printASRs", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printSystem", "[", 
    RowBox[{"system_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"showReps", "=", 
        RowBox[{"OptionValue", "[", "showReps", "]"}]}], ",", 
       RowBox[{"showAmps", "=", 
        RowBox[{"OptionValue", "[", "showAmps", "]"}]}], ",", 
       RowBox[{"showASRs", "=", 
        RowBox[{"OptionValue", "[", "showASRs", "]"}]}], ",", "irreps", ",", 
       "writtenASRs"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"irreps", "=", 
       RowBox[{"system", "[", 
        RowBox[{"[", "\"\<Irreps\>\"", "]"}], "]"}]}], ";", "\n", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<System: \>\"", ",", 
        RowBox[{"Sort", "@", 
         RowBox[{"Flatten", "@", "irreps"}]}]}], "]"}], ";", "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{"showReps", ",", "\n", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<-------------------------\>\"", "]"}], ";",
           "\n", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Number of would-be doublets: \>\"", ",", 
            RowBox[{"system", "[", 
             RowBox[{"[", "\"\<n doublets\>\"", "]"}], "]"}], 
            ",", "\"\<\\n\>\"", ",", "\[IndentingNewLine]", "\"\<In: \>\"", ",", 
            RowBox[{"irreps", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<\\n\>\"", ",", 
            "\[IndentingNewLine]", "\"\<H: \>\"", ",", 
            RowBox[{"irreps", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<\\n\>\"", ",", 
            "\[IndentingNewLine]", "\"\<Out: \>\"", ",", 
            RowBox[{"irreps", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";"}], "\n", ")"}], ",", "\n", "Null"}], "]"}], ";", "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{"showAmps", ",", "\n", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<-------------------------\>\"", "]"}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"printAmps", "[", 
           RowBox[{
            RowBox[{"system", "[", 
             RowBox[{"[", "\"\<Amplitudes\>\"", "]"}], "]"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"FilterRules", "[", 
              RowBox[{
               RowBox[{"{", "opts", "}"}], ",", 
               RowBox[{"Options", "[", "printAmps", "]"}]}], "]"}]}]}], "]"}],
           ";"}], "\n", ")"}], ",", "\n", "Null"}], "]"}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"If", "[", 
       RowBox[{"showASRs", ",", 
        RowBox[{"Print", "[", "\"\<-------------------------\>\"", "]"}], ",",
         "Null"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"writtenASRs", "=", 
       RowBox[{"printASRs", "[", 
        RowBox[{
         RowBox[{"system", "[", 
          RowBox[{"[", "\"\<ASRs\>\"", "]"}], "]"}], ",", 
         RowBox[{"system", "[", 
          RowBox[{"[", "\"\<Amplitudes\>\"", "]"}], "]"}], ",", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"FilterRules", "[", 
           RowBox[{
            RowBox[{"{", "opts", "}"}], ",", 
            RowBox[{"Options", "[", "printASRs", "]"}]}], "]"}]}]}], "]"}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"system", "[", 
        RowBox[{"[", "\"\<Formatted ASRs\>\"", "]"}], "]"}], "=", 
       RowBox[{"Evaluate", "[", "writtenASRs", "]"}]}], ";", "\n", 
      "\[IndentingNewLine]", "system"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.966814889090042*^9, 3.966814894978321*^9}, {
  3.96681527878512*^9, 3.9668153102505455`*^9}, {3.966815418191635*^9, 
  3.966815434406332*^9}, {3.9668156434774055`*^9, 3.96681564567206*^9}, {
  3.9668667999415607`*^9, 3.966866802386324*^9}, {3.966866848384598*^9, 
  3.966866854910961*^9}, {3.967758097089325*^9, 
  3.9677580994117985`*^9}},ExpressionUUID->"2197a131-6a81-2e48-8602-\
9fd79d754800"],

Cell[BoxData[
 RowBox[{"End", "[", "]"}]], "Code",
 CellChangeTimes->{{3.9668144662221203`*^9, 
  3.9668144671096573`*^9}},ExpressionUUID->"2f822f98-bfdf-524f-8f12-\
6e99387e6417"],

Cell[BoxData[
 RowBox[{"EndPackage", "[", "]"}]], "Code",
 CellChangeTimes->{{3.9668144691392384`*^9, 
  3.966814470703684*^9}},ExpressionUUID->"4ce7445f-e663-9240-be66-\
c08c579c3c16"]
},
WindowSize->{960, 532},
WindowMargins->{{-5.5, Automatic}, {Automatic, -5.5}},
Magnification:>0.8 Inherited,
FrontEndVersion->"14.3 for Microsoft Windows (64-bit) (July 8, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"3b3d6322-f340-9d4f-a9bc-15803de649b8"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 445, 8, 40, "Code",ExpressionUUID->"d7755607-cbd2-374e-ad05-ec3d71bc527b"],
Cell[1002, 30, 12414, 202, 939, "Code",ExpressionUUID->"bfe98629-a847-9e41-92fe-50acce952acb"],
Cell[13419, 234, 286, 9, 68, "Code",ExpressionUUID->"468dc405-e98f-d944-9530-65b2f072ecc9"],
Cell[13708, 245, 294, 6, 40, "Code",ExpressionUUID->"df1742f8-e3ff-e24a-bbb8-d2eca0a18691"],
Cell[14005, 253, 1696, 42, 180, "Code",ExpressionUUID->"05555e7c-a6c2-684b-aab7-5668dfef0f53"],
Cell[15704, 297, 1232, 19, 40, "Code",ExpressionUUID->"aa64c93c-fc27-6843-b787-24caf5262f31"],
Cell[16939, 318, 1961, 48, 152, "Code",ExpressionUUID->"3b920bb5-cb45-0245-be13-ce3c447d075c"],
Cell[18903, 368, 542, 16, 40, "Code",ExpressionUUID->"07bc084b-f324-2545-8e8d-5c83b127bf74"],
Cell[19448, 386, 13831, 307, 433, "Code",ExpressionUUID->"5984c2c7-d660-8343-97c4-7ee157add873"],
Cell[33282, 695, 2690, 65, 208, "Code",ExpressionUUID->"880939d3-8af6-344f-8730-7a3378b3ba8f"],
Cell[35975, 762, 6861, 160, 377, "Code",ExpressionUUID->"b8f38615-5711-ca47-ad73-f311a43e531b"],
Cell[42839, 924, 1407, 34, 54, "Code",ExpressionUUID->"e76c6bd5-7ca7-904b-9202-4c539d870962"],
Cell[44249, 960, 7818, 160, 377, "Code",ExpressionUUID->"d3f0884b-1669-1d49-8918-ef4b8bcf66e9"],
Cell[52070, 1122, 809, 21, 68, "Code",ExpressionUUID->"6b6e045b-b322-8a42-a08a-b172d08b7c58"],
Cell[52882, 1145, 5859, 129, 264, "Code",ExpressionUUID->"652dbf7d-bb33-d140-b908-715ec4001dc0"],
Cell[58744, 1276, 3135, 78, 236, "Code",ExpressionUUID->"835ed265-edbd-0343-ac5a-5fe68b21eabd"],
Cell[61882, 1356, 2551, 65, 166, "Code",ExpressionUUID->"ddaa38d6-bebf-664b-b090-3c7a18bc0853"],
Cell[64436, 1423, 19114, 416, 854, "Code",ExpressionUUID->"8fb53ad9-48f1-744a-a398-94d20fa92c0f"],
Cell[83553, 1841, 4575, 106, 433, "Code",ExpressionUUID->"2197a131-6a81-2e48-8602-9fd79d754800"],
Cell[88131, 1949, 180, 4, 40, "Code",ExpressionUUID->"2f822f98-bfdf-524f-8f12-6e99387e6417"],
Cell[88314, 1955, 185, 4, 40, "Code",ExpressionUUID->"4ce7445f-e663-9240-be66-c08c579c3c16"]
}
]
*)

