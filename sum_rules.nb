(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     69734,       1483]
NotebookOptionsPosition[     67832,       1452]
NotebookOutlinePosition[     68264,       1469]
CellTagsIndexPosition[     68221,       1466]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", "\"\<ASRs`\>\"", "]"}], ";"}]], "Code",
 CellChangeTimes->{{3.965430596005556*^9, 3.9654306054256306`*^9}, 
   3.965431487585346*^9, {3.965431695058737*^9, 3.9654316957862053`*^9}, {
   3.965436674649887*^9, 
   3.965436675068756*^9}},ExpressionUUID->"d7755607-cbd2-374e-ad05-\
ec3d71bc527b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"initializePythonSession", "::", "usage"}], "=", 
   "\"\<initializePythonSession[session,path] checks for a valid Python \
session and file path and loads in the Python file.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"defineSystem", "::", "usage"}], "=", 
   "\"\<If phys is False, defineSystem[in,h,out,phys->False] takes in lists \
of the total U-spins in the incoming state, Hamiltonian, and outgoing state \
and returns a Python U-spin System object. If phys is True, the function \
takes in lists of particle multiplets (or CKM factors for the Hamiltonian) in \
the incoming state, Hamiltonian, and outgoing state and returns a Python \
U-spin System object and the list of particle multiplets.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"generateASRs", "::", "usage"}], "=", 
   "\"\<generateASRs[system,particles->{}] takes in a Python U-spin System \
object and optionally a list of particle multiplets and returns the updated \
Python U-spin System object, a list of amplitude sum rule coefficients at \
each order of breaking, and an association containing all amplitudes in the \
system.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"numAmps", "::", "usage"}], "=", 
   "\"\<numAmps[amplitudes] returns the total number of amplitudes in the \
system.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"printAmps", "::", "usage"}], "=", 
   "\"\<printAmps[amplitudes] prints a table of amplitudes and returns the \
number of amplitudes and the amplitude association.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"numASRs", "::", "usage"}], "=", 
   "\"\<numASRs[ASRs] returns the number of amplitude sum rules at each order \
of breaking.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"printASRs", "::", "usage"}], "=", 
   "\"\<printASRs[ASRs,amplitudes,takeProd->False,ampFormat->\\\"a/s \
n-tuple\\\",CKM->False,b->All] prints amplitude sum rules at each order of \
breaking and returns the number of sum rules at each order of breaking and \
the expanded or coefficient form of the sum rules, depending on user choice. \
Valid options for takeProd: True, False; ampFormat: \\\"a/s n-tuple\\\", \
\\\"a/s indices\\\", \\\"a/s nodes\\\", \\\"A indices\\\", \\\"A \
physical\\\"; CKM: True, False; b: an integer 0 <= b <= highest order of \
breaking, All, {start b (min: 0), end b (max: highest order of breaking, or \
All), increment}.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"printSystem", "::", "usage"}], "=", 
   "\"\<printSystem[system,ASRs,amplitudes,opts] prints information about the \
system's representations, a table of amplitudes, and amplitude sum rules at \
each order of breaking. Uses the same options as printASRs to format the \
amplitude sum rules.\>\""}], ";"}]}], "Code",
 CellChangeTimes->{{3.9654306305147057`*^9, 3.965430687936945*^9}, {
   3.965431386784767*^9, 3.9654314041288376`*^9}, 3.965431494843601*^9, {
   3.965433459651066*^9, 3.9654336153908634`*^9}, {3.9654336612445736`*^9, 
   3.9654336640781*^9}, {3.9654368292857323`*^9, 3.9654368396580105`*^9}, {
   3.9654370542961617`*^9, 3.965437058074848*^9}, {3.965437143758339*^9, 
   3.965437146562784*^9}, {3.9654735558952885`*^9, 3.9654735607306004`*^9}, 
   3.965473608819456*^9, {3.965473653434969*^9, 3.965473666441969*^9}, {
   3.9654737191186695`*^9, 3.9654737457297726`*^9}, 3.96547387173028*^9, {
   3.965473974708271*^9, 3.96547401987434*^9}, {3.9654740726305447`*^9, 
   3.965474090206953*^9}, {3.9654741840132637`*^9, 3.9654742862256107`*^9}, {
   3.965474331773567*^9, 3.9654743744081936`*^9}, {3.9654744926430244`*^9, 
   3.9654749783951797`*^9}, {3.9654750155179806`*^9, 3.965475109192539*^9}, {
   3.9654751515308037`*^9, 3.965475188568512*^9}, {3.965475319154829*^9, 
   3.9654755854437656`*^9}, {3.9654756251011696`*^9, 
   3.9654756454827213`*^9}, {3.9654756901737614`*^9, 3.965475716046379*^9}, {
   3.96547585572822*^9, 3.9654759444997406`*^9}, {3.9654759783196945`*^9, 
   3.9654760030095177`*^9}, {3.965476046154745*^9, 3.965476046342926*^9}, {
   3.965476807708885*^9, 3.965476863496973*^9}, {3.9654798658294296`*^9, 
   3.965479887201605*^9}},ExpressionUUID->"bfe98629-a847-9e41-92fe-\
50acce952acb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=."}], ";"}], "\n", 
 RowBox[{
  RowBox[{"a", "=."}], ";"}], "\n", 
 RowBox[{
  RowBox[{"s", "=."}], ";"}]}], "Code",ExpressionUUID->"468dc405-e98f-d944-\
9530-65b2f072ecc9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Code",
 CellChangeTimes->{{3.965430802027622*^9, 3.965430802027622*^9}, 
   3.965431486173973*^9},ExpressionUUID->"df1742f8-e3ff-e24a-bbb8-\
d2eca0a18691"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$ASRsSession", "=."}], ";"}]], "Code",
 CellChangeTimes->{{3.9654273749730663`*^9, 3.965427399699991*^9}, {
   3.965427501287636*^9, 3.965427540883009*^9}, {3.965427573385994*^9, 
   3.965427574649*^9}, {3.965427817152191*^9, 3.965427825094694*^9}, {
   3.9654278806568317`*^9, 3.9654278913700447`*^9}, {3.965428057781994*^9, 
   3.9654280857157*^9}, {3.9654284415013943`*^9, 3.965428556773428*^9}, 
   3.9654287477571545`*^9, {3.9654287995370655`*^9, 3.9654288619335823`*^9}, {
   3.96542892506958*^9, 3.9654289255047417`*^9}, {3.965428958765398*^9, 
   3.965429049927452*^9}, {3.9654291596539288`*^9, 3.9654291896438313`*^9}, {
   3.9654293301555634`*^9, 3.9654295079148254`*^9}, {3.965429583507183*^9, 
   3.965429652161791*^9}, {3.9654297712931576`*^9, 3.965429793189089*^9}, {
   3.9654308686714325`*^9, 3.9654308945931664`*^9}, {3.9654311319645786`*^9, 
   3.96543114227055*^9}, {3.9654312427640457`*^9, 3.96543124351474*^9}, {
   3.965431348945015*^9, 3.9654313493049774`*^9}, {3.9654315170366154`*^9, 
   3.9654315175488605`*^9}, {3.965433336695759*^9, 
   3.9654333724917946`*^9}},ExpressionUUID->"aa64c93c-fc27-6843-b787-\
24caf5262f31"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"initializePythonSession", "[", 
    RowBox[{"session_", ",", "path_String"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"$ASRsSession", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"session", ",", "_ExternalSessionObject"}], "]"}], ",", 
         "\[IndentingNewLine]", "session", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"initializePythonSession", "::", "nosession"}], "]"}], ";", 
          RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FileExistsQ", "[", "path", "]"}], ",", "\[IndentingNewLine]",
         "Null", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"initializePythonSession", "::", "nofile"}], ",", "path"}],
           "]"}], ";", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ExternalEvaluate", "[", 
       RowBox[{"$ASRsSession", ",", 
        RowBox[{"File", "[", "path", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"initializePythonSession", "::", "nosession"}], "=", 
   "\"\<No active Python session provided.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"initializePythonSession", "::", "nofile"}], "=", 
   "\"\<File `1` does not exist.\>\""}], ";"}]}], "Code",
 CellChangeTimes->{
  3.965437435569935*^9},ExpressionUUID->"3b920bb5-cb45-0245-be13-\
ce3c447d075c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pyEval", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"args_", ":", 
      RowBox[{"<|", "|>"}]}]}], "]"}], ":=", 
   RowBox[{"ExternalEvaluate", "[", 
    RowBox[{"$ASRsSession", ",", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<Command\>\"", "->", "expr"}], ",", 
       RowBox[{"\"\<Arguments\>\"", "->", "args"}]}], "|>"}]}], "]"}]}], 
  ";"}]], "Code",ExpressionUUID->"07bc084b-f324-2545-8e8d-5c83b127bf74"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "defineSystem", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"phys", "->", "False"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"defineSystem", "[", 
    RowBox[{"in_", ",", "h_", ",", "out_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"phys", "=", 
        RowBox[{"OptionValue", "[", "phys", "]"}]}], ",", "repSpins", ",", 
       "uIn", ",", "uH", ",", "uOut", ",", "pIn", ",", "pH", ",", "pOut", ",",
        "system", ",", "particles"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"repSpins", "[", "list_", "]"}], ":=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"list", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "-", "1"}], ")"}], "/", 
          "2"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\n", 
      RowBox[{"If", "[", 
       RowBox[{"phys", ",", "\n", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"pIn", ",", "pH", ",", "pOut"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{"in", ",", "h", ",", "out"}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"uIn", ",", "uH", ",", "uOut"}], "}"}], "=", 
           RowBox[{"Map", "[", 
            RowBox[{"repSpins", ",", 
             RowBox[{"{", 
              RowBox[{"pIn", ",", "pH", ",", "pOut"}], "}"}]}], "]"}]}], ";", 
          "\n", 
          RowBox[{"particles", "=", 
           RowBox[{"{", 
            RowBox[{"pIn", ",", "pH", ",", "pOut"}], "}"}]}], ";"}], "\n", 
         ")"}], ",", "\n", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"uIn", ",", "uH", ",", "uOut"}], "}"}], "=", 
          RowBox[{"{", 
           RowBox[{"in", ",", "h", ",", "out"}], "}"}]}], ";"}]}], "\n", 
       "]"}], ";", "\n", 
      RowBox[{"system", "=", 
       RowBox[{"pyEval", "[", 
        RowBox[{"\"\<define_system\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"uIn", ",", "uH", ",", "uOut"}], "}"}], ",", "phys"}], 
          "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"If", "[", 
       RowBox[{"phys", ",", 
        RowBox[{"{", 
         RowBox[{"system", ",", "particles"}], "}"}], ",", "system"}], 
       "]"}]}]}], "\n", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.9654334098345833`*^9, 3.965433410346695*^9}, {
   3.965473909608509*^9, 3.9654739365379543`*^9}, {3.9654761644054356`*^9, 
   3.9654761748442993`*^9}, {3.965476211991638*^9, 3.9654762727694874`*^9}, 
   3.9654763103803864`*^9, {3.965476355814966*^9, 3.9654765311662216`*^9}, 
   3.965476575916849*^9, {3.965476626005413*^9, 3.9654766811265945`*^9}, {
   3.965476757497919*^9, 3.965476788881382*^9}, {3.965479288624241*^9, 
   3.9654792988438816`*^9}},ExpressionUUID->"880939d3-8af6-344f-8730-\
7a3378b3ba8f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "extractAmps", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"particles", "->", 
     RowBox[{"{", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"extractAmps", "[", 
    RowBox[{"system_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"amplitudes", ",", "colNames", ",", 
       RowBox[{"partVal", "=", 
        RowBox[{"OptionValue", "[", "particles", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"amplitudes", "=", 
       RowBox[{"pyEval", "[", 
        RowBox[{"\"\<System.extract_amplitudes\>\"", ",", "system"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"colNames", "=", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Processes\>\"", ",", "\"\<Indices\>\"", ",", "\"\<n-tuple\>\"", 
         ",", "\"\<Node\>\"", ",", "\"\<q factor\>\"", ",", 
         "\"\<p factor\>\"", ",", "\"\<mu\>\"", ",", "\"\<CG\>\""}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"amplitudes", "=", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"AssociationThread", "[", 
           RowBox[{"colNames", ",", "#"}], "]"}], "&"}], "]"}], "@", 
        "amplitudes"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"extractParticles", "[", 
        RowBox[{"particles_", ",", "indices_"}], "]"}], ":=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{"Part", ",", 
            RowBox[{"{", 
             RowBox[{"#1", ",", "#2"}], "}"}]}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"particles", ",", "indices"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "partVal", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"amplitudes", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "\"\<Processes\>\""}], "]"}], "]"}], "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"extractParticles", "[", 
                 RowBox[{"partVal", ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"extractParticles", "[", 
                 RowBox[{"partVal", ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}], "&"}], 
             ",", 
             RowBox[{"amplitudes", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "\"\<Processes\>\""}], "]"}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"amplitudes", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "\"\<CKM\>\""}], "]"}], "]"}], "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
             RowBox[{"amplitudes", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "\"\<Processes\>\""}], "]"}], "]"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"amplitudes", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "\"\<Processes\>\""}], "]"}], "]"}], "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], ",", 
             RowBox[{"amplitudes", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "\"\<Processes\>\""}], "]"}], "]"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"amplitudes", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "\"\<Processes\>\""}], "]"}], "]"}], "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"StringRiffle", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< \>\""}], "]"}], 
                ",", 
                RowBox[{"StringRiffle", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", "\"\< \>\""}], 
                 "]"}]}], "}"}], "&"}], ",", 
             RowBox[{"amplitudes", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "\"\<Processes\>\""}], "]"}], "]"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"amplitudes", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "\"\<Processes\>\""}], "]"}], "]"}], "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"StringJoin", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< \[Rule] \>\"", 
                 ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "}"}], "&"}], ",", 
             RowBox[{"amplitudes", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "\"\<Processes\>\""}], "]"}], "]"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"amplitudes", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "\"\<Processes\>\""}], "]"}], "]"}], "=", 
           RowBox[{"Flatten", "/@", 
            RowBox[{"amplitudes", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "\"\<Processes\>\""}], "]"}], "]"}]}]}], 
          ";"}], "\[IndentingNewLine]", ")"}], ",", "\[IndentingNewLine]", 
        "Null"}], "\[IndentingNewLine]", "]"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "particles", " ", "involved", " ", "in", " ", "specific", " ", 
        "processes"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"amplitudes", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "\"\<mu\>\""}], "]"}], "]"}], "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Sqrt", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "&"}], ",", 
         RowBox[{"amplitudes", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<mu\>\""}], "]"}], "]"}]}], "]"}]}], ";", 
      " ", 
      RowBox[{"(*", " ", 
       RowBox[{"mu", " ", "factors"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"amplitudes", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "\"\<CG\>\""}], "]"}], "]"}], "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ClebschGordan", "@@", 
           RowBox[{"Rationalize", "[", "#", "]"}]}], "&"}], ",", 
         RowBox[{"amplitudes", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<CG\>\""}], "]"}], "]"}]}], "]"}]}], ";", 
      " ", 
      RowBox[{"(*", " ", 
       RowBox[{"CG", " ", "coeffs", " ", "from", " ", "symmetrization"}], " ",
        "*)"}], "\[IndentingNewLine]", "amplitudes"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Code",ExpressionUUID->"5984c2c7-\
d660-8343-97c4-7ee157add873"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "generateASRs", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"particles", "->", 
     RowBox[{"{", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"generateASRs", "[", 
    RowBox[{"system_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"systemVal", "=", "system"}], ",", 
       RowBox[{"partVal", "=", 
        RowBox[{"OptionValue", "[", "particles", "]"}]}], ",", "ASRs", ",", 
       "amplitudes", ",", "dupPairs", ",", "factorsMat"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"systemVal", ",", "ASRs", ",", "dupPairs"}], "}"}], "=", 
       RowBox[{"pyEval", "[", 
        RowBox[{"\"\<generate_srs\>\"", ",", "systemVal"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "M", " ", "values", " ", "for", " ", "symmetrized", " ", "system"}], 
        ",", " ", 
        RowBox[{"contains", " ", "duplicate", " ", "amplitudes"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"amplitudes", "=", 
       RowBox[{"extractAmps", "[", "systemVal", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"factorsMat", "=", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{
         RowBox[{"amplitudes", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<mu\>\""}], "]"}], "]"}], "*", 
         RowBox[{"amplitudes", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "\"\<CG\>\""}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ASRs", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", ".", "factorsMat"}], "&"}], ",", "ASRs"}], "]"}]}], 
      ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"SRs", " ", "for", " ", "symmetrized", " ", "system"}], " ", 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Correct", " ", "for", " ", "duplicate", " ", "amplitudes", " ", 
        "from", " ", "symmetrization"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ASRs", "[", 
           RowBox[{"[", "b", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"dupPairs", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], "+=", 
         RowBox[{
          RowBox[{"ASRs", "[", 
           RowBox[{"[", "b", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"dupPairs", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", 
          RowBox[{"Length", "[", "ASRs", "]"}]}], "}"}]}], "]"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "adds", " ", "together", " ", "cols", " ", "of", " ", "duplicate", " ",
         "amp", " ", "pairs"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ASRs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"Delete", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", "#", "]"}], ",", 
            RowBox[{"List", "/@", 
             RowBox[{"dupPairs", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}], "]"}], 
         "&"}], "/@", "ASRs"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"deletes", " ", "duplicate", " ", "cols"}], " ", "*)"}], "\n", 
      RowBox[{"systemVal", "=", 
       RowBox[{"pyEval", "[", 
        RowBox[{"\"\<remove_dups\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"systemVal", ",", "dupPairs"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"amplitudes", "=", 
       RowBox[{"extractAmps", "[", 
        RowBox[{"systemVal", ",", 
         RowBox[{"particles", "->", "partVal"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ASRs", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"Except", "@", 
           RowBox[{"{", 
            RowBox[{"0", ".."}], "}"}]}], "]"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{"RowReduce", ",", "ASRs"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"systemVal", ",", "ASRs", ",", "amplitudes"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.96547339632358*^9, 3.965473424966324*^9}, 
   3.965473678537565*^9},ExpressionUUID->"b8f38615-5711-ca47-ad73-\
f311a43e531b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"numAmps", "[", "amplitudes_", "]"}], ":=", 
   RowBox[{"Length", "@", 
    RowBox[{"DeleteDuplicates", "@", 
     RowBox[{"Flatten", "@", 
      RowBox[{"amplitudes", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "\"\<Indices\>\""}], "]"}], "]"}]}]}]}]}], 
  ";"}]], "Code",ExpressionUUID->"e76c6bd5-7ca7-904b-9202-4c539d870962"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"printAmps", "[", "amplitudes_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"amplitudesVal", "=", "amplitudes"}], ",", "indices", ",", 
       "selfConjs", ",", "nAmps"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"amplitudesVal", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "\"\<Processes\>\""}], "]"}], "]"}], "=!=", 
         "\"\<n/a\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"indices", "=", 
           RowBox[{"amplitudesVal", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "\"\<Indices\>\""}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"selfConjs", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"indices", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], "==", 
                RowBox[{"indices", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", "i", ",", 
               "Nothing"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "indices", "]"}]}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"amplitudesVal", "[", 
            RowBox[{"[", 
             RowBox[{"selfConjs", ",", "\"\<Processes\>\""}], "]"}], "]"}], 
           "=", 
           RowBox[{"DeleteDuplicates", "/@", 
            RowBox[{"amplitudesVal", "[", 
             RowBox[{"[", 
              RowBox[{"selfConjs", ",", "\"\<Processes\>\""}], "]"}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"amplitudesVal", "[", 
            RowBox[{"[", 
             RowBox[{"selfConjs", ",", "\"\<CKM\>\""}], "]"}], "]"}], "=", 
           RowBox[{"DeleteDuplicates", "/@", 
            RowBox[{"amplitudesVal", "[", 
             RowBox[{"[", 
              RowBox[{"selfConjs", ",", "\"\<CKM\>\""}], "]"}], "]"}]}]}], 
          ";"}], "\[IndentingNewLine]", ")"}], ",", "\[IndentingNewLine]", 
        "Null"}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"amplitudesVal", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "\"\<Indices\>\""}], "]"}], "]"}], "=", 
       RowBox[{"DeleteDuplicates", "/@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"amplitudesVal", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "\"\<Indices\>\""}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "amplitudesVal", "]"}]}], "}"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nAmps", "=", 
       RowBox[{"numAmps", "[", "amplitudesVal", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Amplitude table\>\"", ",", "\"\<\\n\>\"", ",", 
        "\[IndentingNewLine]", "\"\<Number of amplitudes: \>\"", ",", "nAmps",
         ",", "\"\<\\n\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"TableForm", "[", 
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"Values", "/@", "amplitudesVal"}], ",", 
           RowBox[{"Keys", "[", 
            RowBox[{"amplitudesVal", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"nAmps", ",", "amplitudesVal"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.965473432596567*^9, 
  3.9654734550842705`*^9}},ExpressionUUID->"652dbf7d-bb33-d140-b908-\
715ec4001dc0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"numASRs", "[", "ASRs_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"ASRs", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "ASRs", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Code",ExpressionUUID->"ddaa38d6-bebf-664b-b090-3c7a18bc0853"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "printASRs", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"takeProd", "->", "False"}], ",", 
     RowBox[{"ampFormat", "->", "\"\<a/s n-tuple\>\""}], ",", 
     RowBox[{"CKM", "->", "False"}], ",", 
     RowBox[{"b", "->", "All"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printASRs", "[", 
    RowBox[{"ASRs_", ",", "amplitudes_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"takeProd", "=", 
        RowBox[{"OptionValue", "[", "takeProd", "]"}]}], ",", 
       RowBox[{"ampFormat", "=", 
        RowBox[{"OptionValue", "[", "ampFormat", "]"}]}], ",", 
       RowBox[{"CKM", "=", 
        RowBox[{"OptionValue", "[", "CKM", "]"}]}], ",", 
       RowBox[{"b", "=", 
        RowBox[{"OptionValue", "[", "b", "]"}]}], ",", "physicalAmps", ",", 
       "ampsToVector", ",", "ampVector", ",", "writtenASRs", ",", "blist", 
       ",", "numASRsList", ",", "matForm", ",", "rule"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"physicalAmps", "[", 
        RowBox[{"amp_", ",", "asType_", ",", "col_", ",", "CKM_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"asSign", ",", "CKMfactors"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"asSign", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"SymbolName", "[", "asType", "]"}], "==", "\"\<a\>\""}],
              ",", 
             RowBox[{"-", "1"}], ",", 
             RowBox[{"+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"CKMfactors", "=", 
           RowBox[{"If", "[", 
            RowBox[{"CKM", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"amp", "[", 
                RowBox[{"[", 
                 RowBox[{"\"\<CKM\>\"", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"amp", "[", 
                RowBox[{"[", 
                 RowBox[{"\"\<CKM\>\"", ",", "2"}], "]"}], "]"}]}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"amp", "[", 
            RowBox[{"[", "\"\<q factor\>\"", "]"}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"A", "[", 
               RowBox[{"amp", "[", 
                RowBox[{"[", 
                 RowBox[{"col", ",", "1"}], "]"}], "]"}], "]"}], "/", 
              RowBox[{"CKMfactors", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "+", 
             RowBox[{"asSign", "*", 
              RowBox[{"amp", "[", 
               RowBox[{"[", "\"\<p factor\>\"", "]"}], "]"}], "*", 
              RowBox[{
               RowBox[{"A", "[", 
                RowBox[{"amp", "[", 
                 RowBox[{"[", 
                  RowBox[{"col", ",", "2"}], "]"}], "]"}], "]"}], "/", 
               RowBox[{"CKMfactors", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}]}], ")"}]}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ampsToVector", "[", 
        RowBox[{"amps_", ",", "asType_", ",", "ampFormat_", ",", "CKM_"}], 
        "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "vector", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"vector", "=", 
           RowBox[{"Switch", "[", 
            RowBox[{
            "ampFormat", ",", "\[IndentingNewLine]", "\"\<a/s indices\>\"", 
             ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"asType", "[", "#", "]"}], "&"}], ",", 
               RowBox[{"amps", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "\"\<Indices\>\"", ",", "1"}], "]"}], 
                "]"}]}], "]"}], ",", " ", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"a", "/", "s"}], "-", 
               RowBox[{
               "type", " ", "amps", " ", "with", " ", "numbered", " ", 
                "subscripts"}]}], " ", "*)"}], "\[IndentingNewLine]", 
             "\"\<a/s nodes\>\"", ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"asType", "[", "#", "]"}], "&"}], ",", 
               RowBox[{"amps", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "\"\<Node\>\""}], "]"}], "]"}]}], "]"}], 
             ",", " ", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"a", "/", "s"}], "-", 
               RowBox[{"type", " ", "amps", " ", "with", " ", "nodes"}]}], 
              " ", "*)"}], "\[IndentingNewLine]", "\"\<A indices\>\"", ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"physicalAmps", "[", 
                 RowBox[{
                 "#", ",", "asType", ",", "\"\<Indices\>\"", ",", "CKM"}], 
                 "]"}], "&"}], ",", "amps"}], "]"}], ",", " ", 
             RowBox[{"(*", " ", 
              RowBox[{
              "A", " ", "amps", " ", "with", " ", "numbered", " ", 
               "subscripts"}], " ", "*)"}], "\[IndentingNewLine]", 
             "\"\<A physical\>\"", ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"physicalAmps", "[", 
                 RowBox[{
                 "#", ",", "asType", ",", "\"\<Processes\>\"", ",", "CKM"}], 
                 "]"}], "&"}], ",", "amps"}], "]"}], ",", " ", 
             RowBox[{"(*", " ", 
              RowBox[{
              "A", " ", "amps", " ", "with", " ", "physical", " ", 
               "processes"}], " ", "*)"}], "\[IndentingNewLine]", "_", ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"asType", "[", "#", "]"}], "&"}], ",", 
               RowBox[{"amps", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "\"\<n-tuple\>\""}], "]"}], "]"}]}], 
              "]"}]}], " ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"a", "/", "s"}], "-", 
               RowBox[{"type", " ", "amps", " ", "with", " ", "n"}], "-", 
               "tuples"}], ";", " ", 
              RowBox[{"default", " ", "option"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
          "vector"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ampVector", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ampsToVector", "[", 
          RowBox[{"amplitudes", ",", "a", ",", "ampFormat", ",", "CKM"}], 
          "]"}], ",", 
         RowBox[{"ampsToVector", "[", 
          RowBox[{"amplitudes", ",", "s", ",", "ampFormat", ",", "CKM"}], 
          "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"writtenASRs", "=", 
       RowBox[{"If", "[", 
        RowBox[{"takeProd", ",", "\[IndentingNewLine]", 
         RowBox[{"MapIndexed", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"First", "[", "#2", "]"}], "]"}], ",", 
              RowBox[{"#1", ".", 
               RowBox[{"ampVector", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", 
              RowBox[{"#1", ".", 
               RowBox[{"ampVector", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "&"}], ",", 
           "ASRs"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"MapIndexed", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", 
               RowBox[{"First", "[", "#2", "]"}], "]"}], ",", 
              RowBox[{"Prepend", "[", 
               RowBox[{"#1", ",", 
                RowBox[{"ampVector", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"Prepend", "[", 
               RowBox[{"#1", ",", 
                RowBox[{"ampVector", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], "&"}], ",",
            "ASRs"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"b", "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i_", ",", "j_", ",", 
             RowBox[{"k_", ":", "1"}]}], "}"}], ":>", 
           RowBox[{"Span", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Replace", "[", 
              RowBox[{"i", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Null", "->", "1"}], ",", 
                 RowBox[{"x_Integer", ":>", 
                  RowBox[{"x", "+", "1"}]}]}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Replace", "[", 
              RowBox[{"j", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Null", "->", "All"}], ",", 
                 RowBox[{"x_Integer", ":>", 
                  RowBox[{"x", "+", "1"}]}]}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", "k"}], "\[IndentingNewLine]", "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "i_", "}"}], ":>", 
           RowBox[{"Span", "[", 
            RowBox[{
             RowBox[{"Replace", "[", 
              RowBox[{"i", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Null", "->", "1"}], ",", 
                 RowBox[{"x_Integer", ":>", 
                  RowBox[{"x", "+", "1"}]}]}], "}"}]}], "]"}], ",", "All"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"i_Integer", ":>", 
           RowBox[{"Span", "[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", 
             RowBox[{"i", "+", "1"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"All", ":>", "All"}]}], "\[IndentingNewLine]", "}"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"blist", "=", 
       RowBox[{"Flatten", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "ASRs", "]"}], "]"}], "-", "1"}], ")"}], 
          "[", 
          RowBox[{"[", "b", "]"}], "]"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"numASRsList", "=", 
       RowBox[{"numASRs", "[", "ASRs", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"matForm", ":=", 
       RowBox[{"If", "[", 
        RowBox[{"takeProd", ",", 
         RowBox[{
          RowBox[{"MatrixForm", "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{"MatrixForm", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ";;"}], "]"}], "]"}], ",", 
            RowBox[{"TableHeadings", "->", 
             RowBox[{"{", 
              RowBox[{"None", ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}]}], "]"}], "&"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rule", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"x_Symbol", "[", "i_", "]"}], "/;", 
         RowBox[{"x", "=!=", "List"}]}], ":>", 
        RowBox[{"Subscript", "[", 
         RowBox[{"x", ",", "i"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<Sum rules\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<b = \>\"", ",", 
           RowBox[{"blist", "[", 
            RowBox[{"[", 
             RowBox[{"#2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
           "\"\<\\n\>\"", ",", "\[IndentingNewLine]", 
           "\"\<Number of ASRs: \>\"", ",", 
           RowBox[{"numASRsList", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"blist", "[", 
               RowBox[{"[", 
                RowBox[{"#2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "+", "1"}], 
             "]"}], "]"}], ",", "\"\<\\n\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"matForm", "@", 
            RowBox[{"If", "[", 
             RowBox[{"takeProd", ",", 
              RowBox[{"#1", "/.", "rule"}], ",", 
              RowBox[{"ReplacePart", "[", 
               RowBox[{"#1", ",", 
                RowBox[{"1", "->", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/.", "rule"}], ")"}]}]}],
                "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], "&"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"writtenASRs", "[", 
         RowBox[{"[", "b", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"numASRsList", ",", 
        RowBox[{"If", "[", 
         RowBox[{"takeProd", ",", "writtenASRs", ",", "ASRs"}], "]"}]}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.9654374856411266`*^9, 3.96543749947534*^9}, {
  3.9654375590013943`*^9, 
  3.96543756468392*^9}},ExpressionUUID->"9eff8145-9217-a747-a2e7-\
87fc757c4ea1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "printSystem", "]"}], "=", 
   RowBox[{"Options", "[", "printASRs", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printSystem", "[", 
    RowBox[{"system_", ",", "ASRs_", ",", "amplitudes_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "n", ",", "irreps", ",", "nAmps", ",", "nASRs", ",", "writtenASRs"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "irreps"}], "}"}], "=", 
       RowBox[{"pyEval", "[", 
        RowBox[{"\"\<extract_sys\>\"", ",", "system"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<System\>\"", ",", "\"\<\\n\>\"", ",", "\[IndentingNewLine]", 
        "\"\<Number of doublets: \>\"", ",", "n", ",", "\"\<\\n\>\"", ",", 
        "\[IndentingNewLine]", "\"\<System irreps: \>\"", ",", 
        RowBox[{"Sort", "@", 
         RowBox[{"Flatten", "@", "irreps"}]}], ",", "\"\<\\n\>\"", ",", 
        "\[IndentingNewLine]", "\"\<In: \>\"", ",", 
        RowBox[{"irreps", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<\\n\>\"", ",", 
        "\[IndentingNewLine]", "\"\<H: \>\"", ",", 
        RowBox[{"irreps", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<\\n\>\"", ",", 
        "\[IndentingNewLine]", "\"\<Out: \>\"", ",", 
        RowBox[{"irreps", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<-------------------------\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nAmps", "=", 
       RowBox[{
        RowBox[{"printAmps", "[", "amplitudes", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<-------------------------\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nASRs", ",", "writtenASRs"}], "}"}], "=", 
       RowBox[{"printASRs", "[", 
        RowBox[{"ASRs", ",", "amplitudes", ",", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"FilterRules", "[", 
           RowBox[{
            RowBox[{"{", "opts", "}"}], ",", 
            RowBox[{"Options", "[", "printASRs", "]"}]}], "]"}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<n doublets\>\"", "->", "n"}], ",", 
        RowBox[{"\"\<Irreps\>\"", "->", "irreps"}], ",", 
        RowBox[{"\"\<n amps\>\"", "->", "nAmps"}], ",", 
        RowBox[{"\"\<Amplitudes\>\"", "->", "amplitudes"}], ",", 
        RowBox[{"\"\<n ASRs\>\"", "->", "nASRs"}], ",", 
        RowBox[{"\"\<ASRs\>\"", "->", "writtenASRs"}]}], "|>"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.941043074320833*^9, 3.9410432084545097`*^9}, {
   3.94104326966358*^9, 3.941043277048914*^9}, {3.9410433100801277`*^9, 
   3.941043421109354*^9}, {3.9410434844128494`*^9, 3.9410435665979977`*^9}, {
   3.941043613609514*^9, 3.941043788602167*^9}, {3.9410438357800446`*^9, 
   3.941043864417591*^9}, {3.9410440265840855`*^9, 3.9410440269559155`*^9}, {
   3.941044112015354*^9, 3.941044210129719*^9}, {3.9410443230995655`*^9, 
   3.941044323368168*^9}, {3.941044361949459*^9, 3.941044364323086*^9}, {
   3.9410444554847927`*^9, 3.941044515666773*^9}, {3.9410446096190166`*^9, 
   3.9410446623536434`*^9}, {3.941044722185766*^9, 3.9410448794991684`*^9}, {
   3.94104493151462*^9, 3.9410449365693703`*^9}, {3.9410449705626183`*^9, 
   3.941045030791746*^9}, {3.941045062277111*^9, 3.94104518487187*^9}, {
   3.9410453068860474`*^9, 3.941045323115265*^9}, {3.9411193246776295`*^9, 
   3.9411193411902237`*^9}, {3.941119786646488*^9, 3.941119798458021*^9}, {
   3.941119834104809*^9, 3.941119904974493*^9}, {3.9411199748281116`*^9, 
   3.9411200105477066`*^9}, {3.9411200502904987`*^9, 3.941120053634516*^9}, {
   3.9411201025932503`*^9, 3.9411201243671474`*^9}, {3.9411201586658096`*^9, 
   3.941120191146124*^9}, {3.9411202860911045`*^9, 3.9411203740431004`*^9}, {
   3.9411204230205135`*^9, 3.941120435881094*^9}, {3.9411205249671345`*^9, 
   3.941120541829241*^9}, {3.941120835757801*^9, 3.941120901913803*^9}, {
   3.9411209502744446`*^9, 3.9411209737056904`*^9}, {3.941122055737297*^9, 
   3.941122145278324*^9}, {3.941123438492237*^9, 3.941123464872162*^9}, {
   3.9411237427876663`*^9, 3.9411237702391376`*^9}, {3.9411327607851048`*^9, 
   3.9411327897982388`*^9}, {3.9411328486640167`*^9, 
   3.9411329496467094`*^9}, {3.9411329839052505`*^9, 3.941133016036993*^9}, {
   3.941133067567238*^9, 3.941133074730644*^9}, {3.9411332331881027`*^9, 
   3.9411332596313686`*^9}, {3.9411334618019695`*^9, 
   3.9411334619647045`*^9}, {3.941134295448221*^9, 3.9411343212249336`*^9}, {
   3.9411370189688034`*^9, 3.9411370280616856`*^9}, {3.941161232618471*^9, 
   3.9411613071001415`*^9}, {3.9411613874811306`*^9, 3.941161420136221*^9}, {
   3.941161458825014*^9, 3.9411614932374344`*^9}, {3.9411615418706055`*^9, 
   3.9411616368959923`*^9}, {3.941161669656809*^9, 3.9411617085345364`*^9}, {
   3.941162114508625*^9, 3.94116211694853*^9}, {3.9411691794119606`*^9, 
   3.941169179966776*^9}, {3.9411693057676888`*^9, 3.9411693738641033`*^9}, {
   3.941169408632757*^9, 3.9411694108314457`*^9}, {3.941169597885042*^9, 
   3.941169609543789*^9}, {3.9411696937155914`*^9, 3.9411696941861*^9}, {
   3.941170051196638*^9, 3.9411700948775043`*^9}, {3.9420734347407875`*^9, 
   3.942073435550869*^9}, {3.9420771800238457`*^9, 3.942077188626566*^9}, {
   3.9420801552701225`*^9, 3.942080270974407*^9}, 3.94208044425494*^9, {
   3.9420806029432487`*^9, 3.9420806360604496`*^9}, {3.9420947001276894`*^9, 
   3.9420947024017124`*^9}, {3.9420961392149467`*^9, 3.942096140711727*^9}, {
   3.9421273025246983`*^9, 3.94212730269302*^9}, {3.9421276645190945`*^9, 
   3.9421277924251804`*^9}, {3.9421280407565804`*^9, 3.942128058659891*^9}, {
   3.9421585921890087`*^9, 3.94215864009239*^9}, {3.9421586838333664`*^9, 
   3.942158690762167*^9}, 3.9421588607523193`*^9, {3.942158939217638*^9, 
   3.9421589401457176`*^9}, {3.9421589978202343`*^9, 
   3.9421590002172527`*^9}, {3.942159296317957*^9, 3.942159300216919*^9}, {
   3.942159403269102*^9, 3.9421594048655777`*^9}, {3.9421595128158817`*^9, 
   3.942159516119034*^9}, 3.9421596110786743`*^9, {3.947814793286436*^9, 
   3.947814795214449*^9}, {3.949742279831644*^9, 3.949742279972637*^9}, {
   3.949743004557064*^9, 3.9497430055259666`*^9}, {3.9497443893296146`*^9, 
   3.9497443901053047`*^9}, {3.9497445683897457`*^9, 
   3.9497445685049496`*^9}, {3.9497450225651703`*^9, 3.9497450243224144`*^9}, 
   3.9497451425338993`*^9, {3.9497465507439613`*^9, 3.94974655384494*^9}, {
   3.9497472272470493`*^9, 3.9497472282892857`*^9}, {3.9502860687721043`*^9, 
   3.9502860724093113`*^9}, {3.9502974751792164`*^9, 3.950297475415428*^9}, {
   3.950373240140888*^9, 3.950373240287161*^9}, {3.950766043260475*^9, 
   3.9507660923569126`*^9}, {3.9507665296812057`*^9, 
   3.9507665321965675`*^9}, {3.950807622857292*^9, 3.950807628201071*^9}, {
   3.9508077985568905`*^9, 3.9508077996304073`*^9}, {3.9508078998284416`*^9, 
   3.9508079038727493`*^9}, {3.9508079340294075`*^9, 
   3.9508079347297115`*^9}, {3.9509212320120068`*^9, 3.950921234155676*^9}, {
   3.9509222305551147`*^9, 3.9509222310672264`*^9}, {3.950923688149*^9, 
   3.950923688986826*^9}, {3.9509238842779675`*^9, 3.950923887761406*^9}, {
   3.950956619390995*^9, 3.950956643411558*^9}, 3.950976942113922*^9, {
   3.955220873358427*^9, 3.9552208747933426`*^9}, {3.956009123065405*^9, 
   3.9560091262711926`*^9}, {3.9560673837209053`*^9, 3.95606738702054*^9}, {
   3.9598069625581703`*^9, 3.959806966458248*^9}, {3.959807058667101*^9, 
   3.9598070670016136`*^9}, {3.959952496571987*^9, 3.9599525008658752`*^9}, {
   3.959968130398281*^9, 3.9599681405098267`*^9}, {3.9599682630113544`*^9, 
   3.9599682672842903`*^9}, {3.9599683250506763`*^9, 3.959968326599737*^9}, {
   3.95996865101194*^9, 3.9599686712801876`*^9}, {3.9599827964890385`*^9, 
   3.9599828001534405`*^9}, {3.9599855897055187`*^9, 
   3.9599856098583717`*^9}, {3.961498637040251*^9, 3.9614986850061493`*^9}, 
   3.9615118259502087`*^9, {3.9615128189690056`*^9, 3.961512823427866*^9}, {
   3.9615161114153996`*^9, 3.961516125768982*^9}, {3.9615162102543373`*^9, 
   3.9615162914712677`*^9}, {3.9615164497892456`*^9, 3.961516450806902*^9}, {
   3.9615166541728344`*^9, 3.961516677588932*^9}, {3.9615172667682858`*^9, 
   3.961517306204632*^9}, {3.961517950424076*^9, 3.9615179976631756`*^9}, {
   3.9615181043883133`*^9, 3.961518106716341*^9}, {3.9615181759496536`*^9, 
   3.9615181776630344`*^9}, {3.961519037049734*^9, 3.9615190383407917`*^9}, {
   3.9615190754742336`*^9, 3.9615191417608566`*^9}, {3.961519204493376*^9, 
   3.9615192460578938`*^9}, {3.961519283248514*^9, 3.9615193007806053`*^9}, {
   3.961519342912813*^9, 3.961519358297594*^9}, {3.961519410550703*^9, 
   3.9615194512350407`*^9}, {3.961519519244772*^9, 3.9615195203697605`*^9}, {
   3.9615195854379463`*^9, 3.9615196055835667`*^9}, {3.9615197965759163`*^9, 
   3.961519798337919*^9}, {3.9615359919589596`*^9, 3.961536002202484*^9}, {
   3.9615361593426495`*^9, 3.9615362222421513`*^9}, {3.961536267947281*^9, 
   3.9615362755766697`*^9}, {3.961536314466093*^9, 3.961536436747278*^9}, 
   3.961536508083618*^9, {3.9615366070388203`*^9, 3.961536643630493*^9}, {
   3.9615368768199215`*^9, 3.9615369111590023`*^9}, {3.961538153853182*^9, 
   3.961538228621937*^9}, {3.9615383155711613`*^9, 3.9615383217294807`*^9}, {
   3.9615384596185493`*^9, 3.9615384976040325`*^9}, 3.9615387367603474`*^9, {
   3.9615387692265587`*^9, 3.961538797570074*^9}, {3.961538858162964*^9, 
   3.9615388630332794`*^9}, {3.9615389958223896`*^9, 
   3.9615390095970993`*^9}, {3.961539168774433*^9, 3.961539172339937*^9}, {
   3.9615399078944473`*^9, 3.9615399998024864`*^9}, {3.9615404832892857`*^9, 
   3.961540483402199*^9}, {3.9618617293073463`*^9, 3.9618617316483326`*^9}, {
   3.961970663275156*^9, 3.961970678686884*^9}, {3.9619738435521717`*^9, 
   3.9619739026695385`*^9}, {3.961974786272581*^9, 3.961974809134817*^9}, {
   3.961975567977701*^9, 3.961975574945509*^9}, {3.961975907438324*^9, 
   3.9619759113033466`*^9}, {3.961976004443985*^9, 3.961976036167288*^9}, {
   3.961976241892275*^9, 3.9619762741152344`*^9}, {3.961976337972254*^9, 
   3.96197648556983*^9}, 3.9619765692269955`*^9, {3.9619767069247513`*^9, 
   3.9619767146329346`*^9}, {3.961976794125349*^9, 3.9619767943742714`*^9}, {
   3.961976880323223*^9, 3.9619769624238663`*^9}, {3.961977681577751*^9, 
   3.961977712716528*^9}, {3.9619779160041885`*^9, 3.9619779470584564`*^9}, {
   3.9619785560692024`*^9, 3.961978558623396*^9}, {3.961978593607069*^9, 
   3.961978598313387*^9}, {3.9620276023287544`*^9, 3.9620276206174965`*^9}, {
   3.962027668333542*^9, 3.962027670138584*^9}, {3.962027998297617*^9, 
   3.96202800293742*^9}, {3.9621277318004723`*^9, 3.962127732178749*^9}, {
   3.962127842948393*^9, 3.9621278974139023`*^9}, {3.962127977803692*^9, 
   3.962128044998726*^9}, {3.962128084523966*^9, 3.962128094301174*^9}, {
   3.962130272014269*^9, 3.9621302725115585`*^9}, 3.9621307878513107`*^9, {
   3.9621311625035458`*^9, 3.962131169979143*^9}, 3.9621314490243397`*^9, {
   3.962131681017359*^9, 3.962131681175478*^9}, {3.9621320660174236`*^9, 
   3.9621320674087143`*^9}, {3.96213255934725*^9, 3.9621325625006275`*^9}, {
   3.9621331180304203`*^9, 3.9621331553759155`*^9}, {3.9621332549212475`*^9, 
   3.9621332833133945`*^9}, {3.962292536830677*^9, 3.9622925423870144`*^9}, {
   3.962468143178667*^9, 3.9624681488446484`*^9}, {3.962544427694248*^9, 
   3.962544453900917*^9}, 3.962544490996977*^9, {3.9625445391335144`*^9, 
   3.962544604711546*^9}, {3.9625446426056423`*^9, 3.962544938423624*^9}, {
   3.9625449912661343`*^9, 3.9625450072953224`*^9}, {3.9625451739555187`*^9, 
   3.962545180256975*^9}, {3.962545389745613*^9, 3.962545396062628*^9}, {
   3.9625454482690735`*^9, 3.9625454689025764`*^9}, {3.96254551783486*^9, 
   3.962545562670845*^9}, {3.962545746239628*^9, 3.9625457467361946`*^9}, 
   3.962545805338976*^9, 3.962546014754339*^9, {3.962546950808256*^9, 
   3.962546951174799*^9}, {3.9626592425233994`*^9, 3.9626592472723064`*^9}, {
   3.9627175513921165`*^9, 3.96271758721727*^9}, {3.9627177525878716`*^9, 
   3.962717759131752*^9}, {3.9628104441223106`*^9, 3.9628104523026695`*^9}, {
   3.962897665793852*^9, 3.9628977070484962`*^9}, {3.962898140667919*^9, 
   3.962898193827223*^9}, {3.962898248967533*^9, 3.9628982692383842`*^9}, {
   3.962898433930155*^9, 3.9628985237289677`*^9}, {3.962899667529932*^9, 
   3.9628997421030407`*^9}, {3.962899859479641*^9, 3.96289986013579*^9}, {
   3.962899920239002*^9, 3.96289992194586*^9}, {3.9628999752158318`*^9, 
   3.962899975277132*^9}, {3.9629001569823*^9, 3.962900221009796*^9}, {
   3.9629002801178036`*^9, 3.9629003315043545`*^9}, {3.9629004241934185`*^9, 
   3.9629004605858593`*^9}, {3.962900573529396*^9, 3.9629005802640038`*^9}, {
   3.9629006162649384`*^9, 3.9629006229253063`*^9}, 3.962914728337124*^9, {
   3.9629147782113132`*^9, 3.962914874500595*^9}, {3.962915110919256*^9, 
   3.962915116158388*^9}, {3.9629153051111126`*^9, 3.9629153188858795`*^9}, {
   3.9629154482630043`*^9, 3.9629154974420357`*^9}, {3.962915695815712*^9, 
   3.9629156991137943`*^9}, {3.9629158338796635`*^9, 3.962915839760338*^9}, {
   3.9629159815100155`*^9, 3.962915992769949*^9}, {3.962916094588928*^9, 
   3.9629161117078114`*^9}, {3.962916161790476*^9, 3.9629161631574974`*^9}, 
   3.962916261553936*^9, {3.962916353213415*^9, 3.962916356274231*^9}, {
   3.962916588005457*^9, 3.962916595437683*^9}, {3.9629167002738132`*^9, 
   3.9629167271672287`*^9}, {3.962916875270418*^9, 3.9629169259732437`*^9}, {
   3.962917200712944*^9, 3.962917205918667*^9}, {3.9629172510497894`*^9, 
   3.96291726670632*^9}, {3.9629179122914886`*^9, 3.962917918364147*^9}, {
   3.962919207016508*^9, 3.9629192247939205`*^9}, {3.9629192570844*^9, 
   3.962919371402727*^9}, {3.9629197368565865`*^9, 3.962919783452873*^9}, {
   3.9629198371707764`*^9, 3.9629199048173943`*^9}, {3.962919952683962*^9, 
   3.962919955094803*^9}, {3.9629210945549717`*^9, 3.9629211005866394`*^9}, {
   3.9629213748295784`*^9, 3.9629213799751987`*^9}, {3.962921503700201*^9, 
   3.962921509269127*^9}, 3.962921556543152*^9, {3.9629217263560677`*^9, 
   3.9629217321175194`*^9}, {3.9629217732063637`*^9, 3.962921778845381*^9}, {
   3.9629221981382065`*^9, 3.9629222476458664`*^9}, {3.9629223166380024`*^9, 
   3.9629223473668823`*^9}, {3.962923047249382*^9, 3.9629230544020023`*^9}, {
   3.9629230888257713`*^9, 3.9629230956919556`*^9}, {3.9629232615210342`*^9, 
   3.9629232633857117`*^9}, {3.9629233551595592`*^9, 3.962923356807165*^9}, {
   3.962924988944807*^9, 3.9629250194537754`*^9}, {3.962925056718548*^9, 
   3.9629250708602467`*^9}, 3.96292514184733*^9, {3.9629255282093525`*^9, 
   3.9629255282817116`*^9}, {3.9629840749018364`*^9, 3.962984135047571*^9}, 
   3.9629843934596977`*^9, {3.9629844502915955`*^9, 3.9629844524605255`*^9}, {
   3.9629845094837418`*^9, 3.9629845277282543`*^9}, {3.962984607376234*^9, 
   3.962984607551611*^9}, {3.9629846869588776`*^9, 3.962984734915966*^9}, 
   3.962984791798872*^9, {3.9629848234171543`*^9, 3.962984843393488*^9}, {
   3.962984915761545*^9, 3.9629849638588715`*^9}, {3.9629849950171204`*^9, 
   3.9629850199855137`*^9}, {3.962985086323517*^9, 3.9629851263892994`*^9}, {
   3.96298529083119*^9, 3.9629853009735985`*^9}, {3.9629853478149242`*^9, 
   3.962985351212759*^9}, {3.9629854228876057`*^9, 3.962985534903303*^9}, {
   3.962985566518589*^9, 3.962985611893244*^9}, {3.9629858026759644`*^9, 
   3.9629858119885464`*^9}, 3.962985918742466*^9, {3.9629859520585384`*^9, 
   3.962985955888239*^9}, {3.9629859949828644`*^9, 3.962986082801756*^9}, {
   3.9629862771449223`*^9, 3.962986463695511*^9}, {3.9629923237426777`*^9, 
   3.962992324647547*^9}, {3.963319403685034*^9, 3.963319408312849*^9}, 
   3.963319667677799*^9, {3.9633198081882057`*^9, 3.963319853988146*^9}, {
   3.963324650912836*^9, 3.9633246526768627`*^9}, {3.963407914934273*^9, 
   3.96340797265555*^9}, {3.964121053801737*^9, 3.9641210580447216`*^9}, {
   3.964122203586361*^9, 3.964122204837635*^9}, {3.9646222555621815`*^9, 
   3.964622261652176*^9}, 3.964622403440731*^9, {3.9646233872187996`*^9, 
   3.964623481853113*^9}, {3.9646240683060493`*^9, 3.9646242188819027`*^9}, {
   3.9646242634540634`*^9, 3.9646242643836975`*^9}, {3.9646243936693916`*^9, 
   3.964624406309849*^9}, {3.9646244441191998`*^9, 3.964624521324154*^9}, {
   3.9646245764497128`*^9, 3.9646246857166576`*^9}, {3.9646247647452145`*^9, 
   3.9646248601578445`*^9}, {3.9646248962156525`*^9, 3.964624965517311*^9}, {
   3.9646250836321735`*^9, 3.964625179906601*^9}, {3.9646252196066875`*^9, 
   3.9646252928764744`*^9}, {3.9646253797739735`*^9, 
   3.9646254037057266`*^9}, {3.96462547046933*^9, 3.9646255130236874`*^9}, {
   3.9646256299667854`*^9, 3.964625639284895*^9}, {3.9646258116040897`*^9, 
   3.964625834683998*^9}, {3.9646258829607983`*^9, 3.964625950353689*^9}, {
   3.9646259922373943`*^9, 3.9646260032457027`*^9}, {3.964626082063896*^9, 
   3.9646260899353333`*^9}, {3.9646261251383724`*^9, 
   3.9646261713230457`*^9}, {3.96462628137665*^9, 3.9646263331822624`*^9}, {
   3.9646263897419357`*^9, 3.9646264765426674`*^9}, {3.9646265873865833`*^9, 
   3.964626634021263*^9}, {3.964626776513914*^9, 3.964626791160536*^9}, {
   3.9646268857902927`*^9, 3.9646268940901985`*^9}, 3.964626932505131*^9, {
   3.964626987844095*^9, 3.964627034050436*^9}, {3.964627096152975*^9, 
   3.9646271884069996`*^9}, {3.9646272554986897`*^9, 3.964627262276966*^9}, 
   3.9646273130919037`*^9, {3.9646278779615726`*^9, 3.964627935330305*^9}, {
   3.9646280774749966`*^9, 3.9646281615890102`*^9}, {3.964628290195698*^9, 
   3.9646283127498856`*^9}, {3.9646283777368793`*^9, 
   3.9646284076861286`*^9}, {3.964628836257065*^9, 3.9646288457027225`*^9}, {
   3.964628987334553*^9, 3.9646290073043346`*^9}, 3.9646290410457687`*^9, {
   3.9646291283770046`*^9, 3.9646291341017456`*^9}, {3.9646291891338615`*^9, 
   3.964629220315384*^9}, {3.9646292851410713`*^9, 3.9646293161334133`*^9}, {
   3.964629364260908*^9, 3.964629369873083*^9}, {3.964629418512163*^9, 
   3.9646294225605316`*^9}, {3.9646295059688835`*^9, 
   3.9646295069658337`*^9}, {3.964629539898506*^9, 3.9646295521861057`*^9}, {
   3.964629597130453*^9, 3.964629621089258*^9}, {3.9646297262949734`*^9, 
   3.964629729507393*^9}, {3.964630013763418*^9, 3.9646300145673027`*^9}, {
   3.9646300986415443`*^9, 3.964630192321764*^9}, {3.9646358054231224`*^9, 
   3.9646358470570393`*^9}, 3.9647008352187576`*^9, 3.96470385332152*^9, {
   3.964877563218157*^9, 3.9648775647030296`*^9}, {3.964877738731249*^9, 
   3.964877750264271*^9}, {3.9648777934162903`*^9, 3.964877803765375*^9}, {
   3.964877867970745*^9, 3.9648778848784943`*^9}, {3.9648780406479416`*^9, 
   3.9648780755446014`*^9}, {3.9648781175266914`*^9, 
   3.9648781900344124`*^9}, {3.964884837799671*^9, 3.964884857902588*^9}, {
   3.9648850981233673`*^9, 3.9648851884442425`*^9}, {3.9648853297562065`*^9, 
   3.964885330302019*^9}, {3.9648854341241245`*^9, 3.9648854370802402`*^9}, {
   3.9649702757918434`*^9, 3.9649703375289707`*^9}, {3.9649706273341255`*^9, 
   3.9649706500533752`*^9}, {3.96497210294005*^9, 3.9649721099359035`*^9}, {
   3.9651482822755184`*^9, 3.96514831904702*^9}, {3.965148349418312*^9, 
   3.965148421763138*^9}, {3.9651485156870136`*^9, 3.96514856228557*^9}, 
   3.965148611276922*^9, {3.965149108407221*^9, 3.9651492598608513`*^9}, {
   3.9651500278436775`*^9, 3.9651500574513073`*^9}, {3.965150207979912*^9, 
   3.965150210388481*^9}, {3.9651506332386436`*^9, 3.9651506588514175`*^9}, {
   3.96515129190254*^9, 3.9651512993252583`*^9}, {3.9651515009997444`*^9, 
   3.965151502898525*^9}, {3.9651515702263107`*^9, 3.9651515837720184`*^9}, {
   3.9651516698645325`*^9, 3.9651517822029076`*^9}, {3.965152114510769*^9, 
   3.965152141801676*^9}, {3.9652326799790077`*^9, 3.965232716430212*^9}, {
   3.9652330388849144`*^9, 3.9652330418760853`*^9}, {3.9652331806548977`*^9, 
   3.965233181036394*^9}, {3.965233381191845*^9, 3.9652334115905857`*^9}, {
   3.9652336358345127`*^9, 3.9652336389194107`*^9}, {3.965233707297428*^9, 
   3.965233707512657*^9}, 3.965233997857258*^9, {3.9652340988409557`*^9, 
   3.9652341059284554`*^9}, {3.9652341570626926`*^9, 
   3.9652341599937153`*^9}, {3.965234346721609*^9, 3.9652343690349083`*^9}, {
   3.965234502404907*^9, 3.9652345064300194`*^9}, {3.9652345405871296`*^9, 
   3.965234569280176*^9}, 3.965234715031414*^9, {3.965234745674364*^9, 
   3.96523475897727*^9}, {3.965234790755884*^9, 3.965234792572914*^9}, {
   3.9652348725696335`*^9, 3.965234878605383*^9}, {3.9652350135877*^9, 
   3.9652350491617928`*^9}, {3.9652352502061806`*^9, 3.965235271842804*^9}, {
   3.9652547120156097`*^9, 3.965254712785631*^9}, {3.965254837781843*^9, 
   3.965254844669958*^9}, {3.965254878046236*^9, 3.9652548798778076`*^9}, {
   3.965254948052328*^9, 3.9652549586285763`*^9}, {3.965255050597864*^9, 
   3.9652550506682625`*^9}, 3.965402538991745*^9, {3.9654026273135147`*^9, 
   3.965402757695305*^9}, {3.965402809954172*^9, 3.965402819655674*^9}, {
   3.965403220519903*^9, 3.9654032419871063`*^9}, {3.9654033635919437`*^9, 
   3.9654034038119793`*^9}, {3.9654034548425426`*^9, 
   3.9654034657430687`*^9}, {3.965403644296297*^9, 3.9654036478726044`*^9}, {
   3.96540368118412*^9, 3.9654037085425854`*^9}, {3.965403770836111*^9, 
   3.965403891464239*^9}, {3.9654039611769505`*^9, 3.9654040849869366`*^9}, {
   3.965404186171171*^9, 3.96540423818396*^9}, {3.965404270339716*^9, 
   3.9654042885871735`*^9}, {3.9654043399907246`*^9, 3.965404495153406*^9}, {
   3.965404589454483*^9, 3.9654045902803555`*^9}, {3.9654047056207123`*^9, 
   3.9654047418708324`*^9}, {3.965405137259861*^9, 3.965405142822277*^9}, {
   3.9654054980403004`*^9, 3.9654055351601505`*^9}, {3.9654055993158436`*^9, 
   3.9654056293980484`*^9}, {3.9654061744122734`*^9, 3.965406191594372*^9}, {
   3.9654062314831333`*^9, 3.9654062655850697`*^9}, {3.9654064561410923`*^9, 
   3.9654064691628323`*^9}, {3.9654066494508896`*^9, 3.965406711540249*^9}, 
   3.96540674721616*^9, {3.9654068626571255`*^9, 3.9654068633490334`*^9}, {
   3.9654070043919106`*^9, 3.9654070052155647`*^9}, 3.9654071723107433`*^9, {
   3.9654072073400955`*^9, 3.9654073093924694`*^9}, {3.9654073844835854`*^9, 
   3.965407385018446*^9}, {3.965407454498457*^9, 3.9654074553936653`*^9}, {
   3.9654075136126633`*^9, 3.9654075530872498`*^9}, {3.965408145495262*^9, 
   3.965408149852192*^9}, {3.965408218575691*^9, 3.965408223827057*^9}, {
   3.965408342482561*^9, 3.965408344754841*^9}, {3.9654085688786907`*^9, 
   3.965408578699854*^9}, {3.9654088557054443`*^9, 3.9654088762937145`*^9}, {
   3.9654092533508606`*^9, 3.9654093113587055`*^9}, 3.9654258317774677`*^9, {
   3.965430826400051*^9, 3.965430827194189*^9}, {3.965431283359888*^9, 
   3.965431287833254*^9}, {3.9654332432862873`*^9, 
   3.9654333166679287`*^9}},ExpressionUUID->"305fa45b-8615-f445-b6e5-\
1203379f4a95"],

Cell[BoxData[
 RowBox[{"End", "[", "]"}]], "Code",
 CellChangeTimes->{{3.9654308498721237`*^9, 3.9654308498721237`*^9}, 
   3.965431482859415*^9, 
   3.9654366037311115`*^9},ExpressionUUID->"be57b0ef-d2fb-674c-9843-\
de64b41935bb"],

Cell[BoxData[
 RowBox[{"EndPackage", "[", "]"}]], "Code",
 CellChangeTimes->{{3.965431327143305*^9, 3.965431327143305*^9}, 
   3.965431483474449*^9, 
   3.965436605123596*^9},ExpressionUUID->"83be7d60-31ae-0a40-ac67-\
460e44fe35b1"]
},
WindowSize->{960, 532},
WindowMargins->{{-5.5, Automatic}, {Automatic, -5.5}},
Magnification:>0.8 Inherited,
FrontEndVersion->"14.1 for Microsoft Windows (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e03b12aa-5778-b240-96e5-c53c354475ef"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 347, 7, 40, "Code",ExpressionUUID->"d7755607-cbd2-374e-ad05-ec3d71bc527b"],
Cell[904, 29, 4233, 76, 138, "Code",ExpressionUUID->"bfe98629-a847-9e41-92fe-50acce952acb"],
Cell[5140, 107, 215, 7, 68, "Code",ExpressionUUID->"468dc405-e98f-d944-9530-65b2f072ecc9"],
Cell[5358, 116, 240, 5, 40, "Code",ExpressionUUID->"df1742f8-e3ff-e24a-bbb8-d2eca0a18691"],
Cell[5601, 123, 1182, 18, 40, "Code",ExpressionUUID->"aa64c93c-fc27-6843-b787-24caf5262f31"],
Cell[6786, 143, 1816, 46, 194, "Code",ExpressionUUID->"3b920bb5-cb45-0245-be13-ce3c447d075c"],
Cell[8605, 191, 471, 13, 40, "Code",ExpressionUUID->"07bc084b-f324-2545-8e8d-5c83b127bf74"],
Cell[9079, 206, 3223, 84, 208, "Code",ExpressionUUID->"880939d3-8af6-344f-8730-7a3378b3ba8f"],
Cell[12305, 292, 8081, 203, 335, "Code",ExpressionUUID->"5984c2c7-d660-8343-97c4-7ee157add873"],
Cell[20389, 497, 4902, 126, 278, "Code",ExpressionUUID->"b8f38615-5711-ca47-ad73-f311a43e531b"],
Cell[25294, 625, 385, 10, 40, "Code",ExpressionUUID->"e76c6bd5-7ca7-904b-9202-4c539d870962"],
Cell[25682, 637, 4071, 99, 321, "Code",ExpressionUUID->"652dbf7d-bb33-d140-b908-715ec4001dc0"],
Cell[29756, 738, 415, 12, 40, "Code",ExpressionUUID->"ddaa38d6-bebf-664b-b090-3c7a18bc0853"],
Cell[30174, 752, 13930, 341, 756, "Code",ExpressionUUID->"9eff8145-9217-a747-a2e7-87fc757c4ea1"],
Cell[44107, 1095, 23252, 341, 264, "Code",ExpressionUUID->"305fa45b-8615-f445-b6e5-1203379f4a95"],
Cell[67362, 1438, 231, 5, 40, "Code",ExpressionUUID->"be57b0ef-d2fb-674c-9843-de64b41935bb"],
Cell[67596, 1445, 232, 5, 40, "Code",ExpressionUUID->"83be7d60-31ae-0a40-ac67-460e44fe35b1"]
}
]
*)

